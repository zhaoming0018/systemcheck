Loading data...
Number of encoded image: 8
Number of synthesized data: 16384
Number of training data, output: 560, 40...
Building model and compiling functions...
Number of parameters in model: 466104
Starting training...
train.py:71: DeprecationWarning: This function is deprecated. Please call randint(0, 8 + 1) instead
  crops = np.random.random_integers(0, high=8, size=(batchsize, 2))
Epoch 1 of 100 took 16.914s
  training loss:		1.587155
  malicious loss:		1.293248
  malicious accuracy:		44.80 %
  validation loss:		3.727335
  validation accuracy:		4.17 %
Epoch 2 of 100 took 16.253s
  training loss:		1.593801
  malicious loss:		1.382124
  malicious accuracy:		46.26 %
  validation loss:		3.362150
  validation accuracy:		7.50 %
Epoch 3 of 100 took 16.185s
  training loss:		1.527138
  malicious loss:		1.215817
  malicious accuracy:		49.57 %
  validation loss:		3.775334
  validation accuracy:		2.50 %
Epoch 4 of 100 took 16.205s
  training loss:		1.508604
  malicious loss:		1.189000
  malicious accuracy:		51.52 %
  validation loss:		3.973816
  validation accuracy:		6.67 %
Epoch 5 of 100 took 16.383s
  training loss:		1.378484
  malicious loss:		1.062807
  malicious accuracy:		57.23 %
  validation loss:		4.387234
  validation accuracy:		8.33 %
Epoch 6 of 100 took 16.229s
  training loss:		1.299960
  malicious loss:		1.054286
  malicious accuracy:		55.90 %
  validation loss:		3.118610
  validation accuracy:		14.17 %
Epoch 7 of 100 took 16.383s
  training loss:		1.207862
  malicious loss:		1.032869
  malicious accuracy:		56.37 %
  validation loss:		3.166401
  validation accuracy:		13.33 %
Epoch 8 of 100 took 16.137s
  training loss:		1.101546
  malicious loss:		0.878655
  malicious accuracy:		63.34 %
  validation loss:		2.792881
  validation accuracy:		20.00 %
Epoch 9 of 100 took 16.187s
  training loss:		1.019805
  malicious loss:		0.822127
  malicious accuracy:		66.08 %
  validation loss:		2.438041
  validation accuracy:		29.17 %
Epoch 10 of 100 took 16.111s
  training loss:		0.953311
  malicious loss:		0.775202
  malicious accuracy:		68.77 %
  validation loss:		2.164463
  validation accuracy:		35.83 %
Epoch 11 of 100 took 16.169s
  training loss:		0.900713
  malicious loss:		0.940043
  malicious accuracy:		63.40 %
  validation loss:		1.774969
  validation accuracy:		43.33 %
Epoch 12 of 100 took 16.207s
  training loss:		0.855011
  malicious loss:		0.722632
  malicious accuracy:		70.03 %
  validation loss:		1.527385
  validation accuracy:		54.17 %
Epoch 13 of 100 took 16.105s
  training loss:		0.817024
  malicious loss:		0.706654
  malicious accuracy:		69.98 %
  validation loss:		1.419955
  validation accuracy:		52.50 %
Epoch 14 of 100 took 16.235s
  training loss:		0.781558
  malicious loss:		0.679264
  malicious accuracy:		72.74 %
  validation loss:		1.085737
  validation accuracy:		61.67 %
Epoch 15 of 100 took 16.186s
  training loss:		0.743365
  malicious loss:		0.680063
  malicious accuracy:		71.31 %
  validation loss:		1.576476
  validation accuracy:		53.33 %
Epoch 16 of 100 took 16.219s
  training loss:		0.720726
  malicious loss:		0.720613
  malicious accuracy:		70.20 %
  validation loss:		1.151580
  validation accuracy:		65.83 %
Epoch 17 of 100 took 16.271s
  training loss:		0.677698
  malicious loss:		0.590784
  malicious accuracy:		74.91 %
  validation loss:		1.197268
  validation accuracy:		71.67 %
Epoch 18 of 100 took 16.380s
  training loss:		0.687645
  malicious loss:		0.574615
  malicious accuracy:		76.18 %
  validation loss:		0.861311
  validation accuracy:		71.67 %
Epoch 19 of 100 took 16.262s
  training loss:		0.640242
  malicious loss:		0.541397
  malicious accuracy:		77.18 %
  validation loss:		0.789760
  validation accuracy:		74.17 %
Epoch 20 of 100 took 16.269s
  training loss:		0.631753
  malicious loss:		0.651382
  malicious accuracy:		73.53 %
  validation loss:		0.954660
  validation accuracy:		74.17 %
Epoch 21 of 100 took 16.315s
  training loss:		0.607109
  malicious loss:		0.684534
  malicious accuracy:		73.61 %
  validation loss:		1.303711
  validation accuracy:		65.83 %
Epoch 22 of 100 took 16.256s
  training loss:		0.571723
  malicious loss:		0.500710
  malicious accuracy:		79.49 %
  validation loss:		0.633684
  validation accuracy:		84.17 %
Epoch 23 of 100 took 16.239s
  training loss:		0.570116
  malicious loss:		0.473863
  malicious accuracy:		80.89 %
  validation loss:		0.640560
  validation accuracy:		82.50 %
Epoch 24 of 100 took 16.265s
  training loss:		0.556943
  malicious loss:		0.515312
  malicious accuracy:		79.68 %
  validation loss:		0.632157
  validation accuracy:		77.50 %
Epoch 25 of 100 took 16.335s
  training loss:		0.543377
  malicious loss:		0.477506
  malicious accuracy:		80.45 %
  validation loss:		0.617031
  validation accuracy:		82.50 %
Epoch 26 of 100 took 16.252s
  training loss:		0.538650
  malicious loss:		0.503680
  malicious accuracy:		80.57 %
  validation loss:		0.653732
  validation accuracy:		80.00 %
Epoch 27 of 100 took 16.235s
  training loss:		0.519303
  malicious loss:		0.446145
  malicious accuracy:		81.84 %
  validation loss:		0.641268
  validation accuracy:		78.33 %
Epoch 28 of 100 took 16.221s
  training loss:		0.501784
  malicious loss:		0.440940
  malicious accuracy:		81.84 %
  validation loss:		0.704951
  validation accuracy:		80.83 %
Epoch 29 of 100 took 16.283s
  training loss:		0.486790
  malicious loss:		0.520144
  malicious accuracy:		78.37 %
  validation loss:		0.592481
  validation accuracy:		83.33 %
Epoch 30 of 100 took 16.167s
  training loss:		0.491746
  malicious loss:		0.484316
  malicious accuracy:		80.28 %
  validation loss:		0.693786
  validation accuracy:		81.67 %
Epoch 31 of 100 took 16.419s
  training loss:		0.478879
  malicious loss:		0.644172
  malicious accuracy:		75.59 %
  validation loss:		0.752493
  validation accuracy:		76.67 %
Epoch 32 of 100 took 16.151s
  training loss:		0.474695
  malicious loss:		0.370967
  malicious accuracy:		85.52 %
  validation loss:		0.522249
  validation accuracy:		88.33 %
Epoch 33 of 100 took 16.510s
  training loss:		0.449451
  malicious loss:		0.430146
  malicious accuracy:		82.26 %
  validation loss:		0.725136
  validation accuracy:		80.83 %
Epoch 34 of 100 took 16.187s
  training loss:		0.452232
  malicious loss:		0.417656
  malicious accuracy:		82.98 %
  validation loss:		0.602302
  validation accuracy:		83.33 %
Epoch 35 of 100 took 16.196s
  training loss:		0.446238
  malicious loss:		0.378817
  malicious accuracy:		84.66 %
  validation loss:		0.677283
  validation accuracy:		82.50 %
Epoch 36 of 100 took 16.127s
  training loss:		0.433217
  malicious loss:		0.342995
  malicious accuracy:		86.86 %
  validation loss:		1.012574
  validation accuracy:		72.50 %
Epoch 37 of 100 took 16.139s
  training loss:		0.430925
  malicious loss:		0.418843
  malicious accuracy:		83.65 %
  validation loss:		0.555185
  validation accuracy:		84.17 %
Epoch 38 of 100 took 16.134s
  training loss:		0.410543
  malicious loss:		0.427635
  malicious accuracy:		82.81 %
  validation loss:		0.452510
  validation accuracy:		88.33 %
Epoch 39 of 100 took 16.411s
  training loss:		0.413632
  malicious loss:		0.410380
  malicious accuracy:		83.80 %
  validation loss:		0.438990
  validation accuracy:		85.00 %
Epoch 40 of 100 took 16.220s
  training loss:		0.410578
  malicious loss:		0.378690
  malicious accuracy:		84.82 %
  validation loss:		0.831890
  validation accuracy:		79.17 %
Epoch 41 of 100 took 16.127s
  training loss:		0.396439
  malicious loss:		0.285603
  malicious accuracy:		89.03 %
  validation loss:		0.541819
  validation accuracy:		86.67 %
Epoch 42 of 100 took 16.371s
  training loss:		0.231161
  malicious loss:		0.150139
  malicious accuracy:		95.72 %
  validation loss:		0.367305
  validation accuracy:		90.83 %
Epoch 43 of 100 took 16.141s
  training loss:		0.171523
  malicious loss:		0.124201
  malicious accuracy:		96.86 %
  validation loss:		0.354936
  validation accuracy:		90.00 %
Epoch 44 of 100 took 16.215s
  training loss:		0.149323
  malicious loss:		0.102686
  malicious accuracy:		97.68 %
  validation loss:		0.347383
  validation accuracy:		91.67 %
Epoch 45 of 100 took 16.256s
  training loss:		0.131963
  malicious loss:		0.088113
  malicious accuracy:		98.14 %
  validation loss:		0.311669
  validation accuracy:		92.50 %
Epoch 46 of 100 took 16.287s
  training loss:		0.117387
  malicious loss:		0.079286
  malicious accuracy:		98.46 %
  validation loss:		0.338468
  validation accuracy:		90.83 %
Epoch 47 of 100 took 16.195s
  training loss:		0.109861
  malicious loss:		0.076545
  malicious accuracy:		98.31 %
  validation loss:		0.317356
  validation accuracy:		92.50 %
Epoch 48 of 100 took 16.215s
  training loss:		0.099152
  malicious loss:		0.059790
  malicious accuracy:		99.02 %
  validation loss:		0.293344
  validation accuracy:		93.33 %
Epoch 49 of 100 took 16.209s
  training loss:		0.093092
  malicious loss:		0.053452
  malicious accuracy:		99.12 %
  validation loss:		0.312608
  validation accuracy:		92.50 %
Epoch 50 of 100 took 16.223s
  training loss:		0.083658
  malicious loss:		0.049518
  malicious accuracy:		99.26 %
  validation loss:		0.304362
  validation accuracy:		90.83 %
Epoch 51 of 100 took 16.318s
  training loss:		0.077876
  malicious loss:		0.043780
  malicious accuracy:		99.41 %
  validation loss:		0.299711
  validation accuracy:		89.17 %
Epoch 52 of 100 took 16.192s
  training loss:		0.069060
  malicious loss:		0.038695
  malicious accuracy:		99.54 %
  validation loss:		0.328671
  validation accuracy:		90.83 %
Epoch 53 of 100 took 16.455s
  training loss:		0.065269
  malicious loss:		0.035243
  malicious accuracy:		99.56 %
  validation loss:		0.339345
  validation accuracy:		89.17 %
Epoch 54 of 100 took 16.210s
  training loss:		0.060536
  malicious loss:		0.030436
  malicious accuracy:		99.75 %
  validation loss:		0.334610
  validation accuracy:		89.17 %
Epoch 55 of 100 took 16.532s
  training loss:		0.057244
  malicious loss:		0.027310
  malicious accuracy:		99.77 %
  validation loss:		0.309963
  validation accuracy:		90.00 %
Epoch 56 of 100 took 16.279s
  training loss:		0.056176
  malicious loss:		0.025656
  malicious accuracy:		99.79 %
  validation loss:		0.323974
  validation accuracy:		91.67 %
Epoch 57 of 100 took 16.231s
  training loss:		0.048524
  malicious loss:		0.024297
  malicious accuracy:		99.73 %
  validation loss:		0.324574
  validation accuracy:		90.83 %
Epoch 58 of 100 took 16.208s
  training loss:		0.046266
  malicious loss:		0.019606
  malicious accuracy:		99.87 %
  validation loss:		0.282987
  validation accuracy:		91.67 %
Epoch 59 of 100 took 16.219s
  training loss:		0.044079
  malicious loss:		0.019043
  malicious accuracy:		99.88 %
  validation loss:		0.289146
  validation accuracy:		90.00 %
Epoch 60 of 100 took 16.212s
  training loss:		0.043915
  malicious loss:		0.019022
  malicious accuracy:		99.85 %
  validation loss:		0.329329
  validation accuracy:		90.00 %
Epoch 61 of 100 took 16.211s
  training loss:		0.040191
  malicious loss:		0.016464
  malicious accuracy:		99.93 %
  validation loss:		0.337412
  validation accuracy:		90.00 %
Epoch 62 of 100 took 16.427s
  training loss:		0.030328
  malicious loss:		0.013385
  malicious accuracy:		99.96 %
  validation loss:		0.313406
  validation accuracy:		90.00 %
Epoch 63 of 100 took 16.195s
  training loss:		0.029175
  malicious loss:		0.012865
  malicious accuracy:		99.98 %
  validation loss:		0.341343
  validation accuracy:		90.00 %
Epoch 64 of 100 took 16.376s
  training loss:		0.026636
  malicious loss:		0.012066
  malicious accuracy:		99.98 %
  validation loss:		0.339401
  validation accuracy:		90.00 %
Epoch 65 of 100 took 16.209s
  training loss:		0.028003
  malicious loss:		0.011884
  malicious accuracy:		99.98 %
  validation loss:		0.326862
  validation accuracy:		90.00 %
Epoch 66 of 100 took 16.199s
  training loss:		0.026636
  malicious loss:		0.012056
  malicious accuracy:		99.96 %
  validation loss:		0.346612
  validation accuracy:		90.00 %
Epoch 67 of 100 took 16.284s
  training loss:		0.027211
  malicious loss:		0.011259
  malicious accuracy:		99.98 %
  validation loss:		0.340851
  validation accuracy:		90.00 %
Epoch 68 of 100 took 16.215s
  training loss:		0.027002
  malicious loss:		0.011627
  malicious accuracy:		99.99 %
  validation loss:		0.339047
  validation accuracy:		89.17 %
Epoch 69 of 100 took 16.223s
  training loss:		0.027613
  malicious loss:		0.011645
  malicious accuracy:		99.98 %
  validation loss:		0.321504
  validation accuracy:		90.00 %
Epoch 70 of 100 took 16.227s
  training loss:		0.024991
  malicious loss:		0.010731
  malicious accuracy:		99.98 %
  validation loss:		0.336513
  validation accuracy:		90.00 %
Epoch 71 of 100 took 16.222s
  training loss:		0.024271
  malicious loss:		0.011212
  malicious accuracy:		99.98 %
  validation loss:		0.331272
  validation accuracy:		90.83 %
Epoch 72 of 100 took 16.251s
  training loss:		0.024891
  malicious loss:		0.010266
  malicious accuracy:		99.99 %
  validation loss:		0.347230
  validation accuracy:		90.00 %
Epoch 73 of 100 took 16.307s
  training loss:		0.023524
  malicious loss:		0.009684
  malicious accuracy:		100.00 %
  validation loss:		0.313122
  validation accuracy:		89.17 %
Epoch 74 of 100 took 16.223s
  training loss:		0.025143
  malicious loss:		0.010514
  malicious accuracy:		99.99 %
  validation loss:		0.338339
  validation accuracy:		89.17 %
Epoch 75 of 100 took 16.263s
  training loss:		0.023709
  malicious loss:		0.009532
  malicious accuracy:		100.00 %
  validation loss:		0.326485
  validation accuracy:		90.00 %
Epoch 76 of 100 took 16.205s
  training loss:		0.025192
  malicious loss:		0.010357
  malicious accuracy:		99.99 %
  validation loss:		0.328667
  validation accuracy:		90.00 %
Epoch 77 of 100 took 16.239s
  training loss:		0.022107
  malicious loss:		0.009457
  malicious accuracy:		99.99 %
  validation loss:		0.326545
  validation accuracy:		90.00 %
Epoch 78 of 100 took 16.292s
  training loss:		0.022490
  malicious loss:		0.009605
  malicious accuracy:		99.99 %
  validation loss:		0.320860
  validation accuracy:		90.00 %
Epoch 79 of 100 took 16.239s
  training loss:		0.023728
  malicious loss:		0.009317
  malicious accuracy:		99.99 %
  validation loss:		0.326190
  validation accuracy:		89.17 %
Epoch 80 of 100 took 16.211s
  training loss:		0.023560
  malicious loss:		0.008828
  malicious accuracy:		99.99 %
  validation loss:		0.341210
  validation accuracy:		89.17 %
Epoch 81 of 100 took 16.203s
  training loss:		0.023451
  malicious loss:		0.009109
  malicious accuracy:		100.00 %
  validation loss:		0.313363
  validation accuracy:		89.17 %
Epoch 82 of 100 took 16.218s
  training loss:		0.023363
  malicious loss:		0.009313
  malicious accuracy:		99.99 %
  validation loss:		0.337343
  validation accuracy:		90.00 %
Epoch 83 of 100 took 16.289s
  training loss:		0.022640
  malicious loss:		0.009324
  malicious accuracy:		100.00 %
  validation loss:		0.316750
  validation accuracy:		89.17 %
Epoch 84 of 100 took 16.281s
  training loss:		0.022915
  malicious loss:		0.008504
  malicious accuracy:		99.99 %
  validation loss:		0.332156
  validation accuracy:		90.00 %
Epoch 85 of 100 took 16.215s
  training loss:		0.022148
  malicious loss:		0.008880
  malicious accuracy:		100.00 %
  validation loss:		0.311152
  validation accuracy:		90.00 %
Epoch 86 of 100 took 16.203s
  training loss:		0.022131
  malicious loss:		0.008552
  malicious accuracy:		99.99 %
  validation loss:		0.338891
  validation accuracy:		89.17 %
Epoch 87 of 100 took 16.324s
  training loss:		0.021949
  malicious loss:		0.008416
  malicious accuracy:		99.99 %
  validation loss:		0.326036
  validation accuracy:		90.00 %
Epoch 88 of 100 took 16.220s
  training loss:		0.022216
  malicious loss:		0.008184
  malicious accuracy:		100.00 %
  validation loss:		0.318882
  validation accuracy:		89.17 %
Epoch 89 of 100 took 16.303s
  training loss:		0.021087
  malicious loss:		0.008340
  malicious accuracy:		100.00 %
  validation loss:		0.313917
  validation accuracy:		90.00 %
Epoch 90 of 100 took 16.231s
  training loss:		0.021464
  malicious loss:		0.007674
  malicious accuracy:		100.00 %
  validation loss:		0.321531
  validation accuracy:		89.17 %
Epoch 91 of 100 took 16.219s
  training loss:		0.021918
  malicious loss:		0.008375
  malicious accuracy:		99.99 %
  validation loss:		0.311847
  validation accuracy:		90.00 %
Epoch 92 of 100 took 16.489s
  training loss:		0.020193
  malicious loss:		0.007775
  malicious accuracy:		100.00 %
  validation loss:		0.304532
  validation accuracy:		90.00 %
Epoch 93 of 100 took 16.220s
  training loss:		0.021406
  malicious loss:		0.008285
  malicious accuracy:		100.00 %
  validation loss:		0.311582
  validation accuracy:		90.00 %
Epoch 94 of 100 took 16.279s
  training loss:		0.020493
  malicious loss:		0.007792
  malicious accuracy:		99.99 %
  validation loss:		0.320875
  validation accuracy:		90.00 %
Epoch 95 of 100 took 16.255s
  training loss:		0.020871
  malicious loss:		0.008029
  malicious accuracy:		100.00 %
  validation loss:		0.310601
  validation accuracy:		90.00 %
Epoch 96 of 100 took 16.224s
  training loss:		0.019922
  malicious loss:		0.008127
  malicious accuracy:		100.00 %
  validation loss:		0.328981
  validation accuracy:		89.17 %
Epoch 97 of 100 took 16.224s
  training loss:		0.020887
  malicious loss:		0.007774
  malicious accuracy:		100.00 %
  validation loss:		0.297803
  validation accuracy:		90.83 %
Epoch 98 of 100 took 16.229s
  training loss:		0.018938
  malicious loss:		0.007269
  malicious accuracy:		100.00 %
  validation loss:		0.309855
  validation accuracy:		90.00 %
Epoch 99 of 100 took 16.316s
  training loss:		0.019367
  malicious loss:		0.007342
  malicious accuracy:		100.00 %
  validation loss:		0.308168
  validation accuracy:		90.00 %
Epoch 100 of 100 took 16.303s
  training loss:		0.018592
  malicious loss:		0.006784
  malicious accuracy:		100.00 %
  validation loss:		0.319659
  validation accuracy:		90.00 %
Final results:
  test loss:			0.319659
  test accuracy:		90.00 %
tensor([ 0,  0,  0,  1,  1,  1,  2, 12, 12,  3,  3,  3,  4,  4,  5,  5,  5,  5,
         6,  6,  5,  7,  7,  7,  8,  8,  8,  9,  9,  7, 10, 10, 10, 11, 11, 11,
        12, 12, 12, 13], device='cuda:0')
tensor([13, 13, 14, 14, 14, 15, 15, 15, 16, 16, 16, 17, 17, 17, 18, 18, 18, 19,
        19, 19, 28, 20, 20, 21, 21, 21, 22, 22, 37, 23, 23, 23, 24, 24, 24, 25,
        25, 12, 26, 26], device='cuda:0')
tensor([26, 27, 27, 27, 28, 38, 28, 29, 29, 29, 30, 30, 30,  1,  1, 31, 32, 32,
        32, 33, 33, 33, 34, 34, 34, 35, 35, 35, 36, 36, 36, 37, 37, 37, 38, 38,
        38, 39,  5, 39], device='cuda:0')
0.9
