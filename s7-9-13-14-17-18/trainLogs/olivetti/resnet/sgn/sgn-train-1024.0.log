Loading data...
Raw data shape (280, 32, 32)
Number of training data, output: 560, 40...
Building model and compiling functions...
Number of parameters in model: 466104
Number of data sign-encoded: 56
Number of params greater than targets
Starting training...
train.py:71: DeprecationWarning: This function is deprecated. Please call randint(0, 8 + 1) instead
  crops = np.random.random_integers(0, high=8, size=(batchsize, 2))
Epoch 1 of 100 took 1.261s
  training loss:		28.864079
  training r:		0.531780
  validation loss:		20.251194
  validation accuracy:		6.67 %
Epoch 2 of 100 took 0.610s
  training loss:		19.279963
  training r:		0.658487
  validation loss:		3.481152
  validation accuracy:		6.67 %
Epoch 3 of 100 took 0.609s
  training loss:		11.122012
  training r:		0.798423
  validation loss:		3.525195
  validation accuracy:		15.83 %
Epoch 4 of 100 took 0.611s
  training loss:		6.380311
  training r:		0.896551
  validation loss:		3.295706
  validation accuracy:		20.83 %
Epoch 5 of 100 took 0.615s
  training loss:		4.223929
  training r:		0.948445
  validation loss:		2.766187
  validation accuracy:		29.17 %
Epoch 6 of 100 took 0.619s
  training loss:		2.981273
  training r:		0.972783
  validation loss:		3.186578
  validation accuracy:		22.50 %
Epoch 7 of 100 took 0.607s
  training loss:		2.333500
  training r:		0.982582
  validation loss:		2.641904
  validation accuracy:		32.50 %
Epoch 8 of 100 took 0.611s
  training loss:		2.027549
  training r:		0.985691
  validation loss:		2.598339
  validation accuracy:		24.17 %
Epoch 9 of 100 took 0.600s
  training loss:		1.802465
  training r:		0.986128
  validation loss:		1.764356
  validation accuracy:		47.50 %
Epoch 10 of 100 took 0.619s
  training loss:		1.418840
  training r:		0.986500
  validation loss:		2.474252
  validation accuracy:		41.67 %
Epoch 11 of 100 took 0.623s
  training loss:		1.312663
  training r:		0.987252
  validation loss:		2.772319
  validation accuracy:		37.50 %
Epoch 12 of 100 took 0.619s
  training loss:		1.209322
  training r:		0.987709
  validation loss:		3.097053
  validation accuracy:		45.83 %
Epoch 13 of 100 took 0.603s
  training loss:		0.947387
  training r:		0.988965
  validation loss:		1.607913
  validation accuracy:		61.67 %
Epoch 14 of 100 took 0.627s
  training loss:		0.955128
  training r:		0.988715
  validation loss:		2.285520
  validation accuracy:		40.00 %
Epoch 15 of 100 took 0.619s
  training loss:		0.775935
  training r:		0.987361
  validation loss:		1.709612
  validation accuracy:		62.50 %
Epoch 16 of 100 took 0.615s
  training loss:		0.608936
  training r:		0.990232
  validation loss:		1.590797
  validation accuracy:		60.83 %
Epoch 17 of 100 took 0.615s
  training loss:		0.634199
  training r:		0.990835
  validation loss:		1.988744
  validation accuracy:		52.50 %
Epoch 18 of 100 took 0.619s
  training loss:		0.490258
  training r:		0.991261
  validation loss:		2.215989
  validation accuracy:		55.00 %
Epoch 19 of 100 took 0.603s
  training loss:		0.608143
  training r:		0.989804
  validation loss:		1.877901
  validation accuracy:		54.17 %
Epoch 20 of 100 took 0.641s
  training loss:		0.610599
  training r:		0.988037
  validation loss:		1.459279
  validation accuracy:		65.83 %
Epoch 21 of 100 took 0.616s
  training loss:		0.466372
  training r:		0.990281
  validation loss:		1.511690
  validation accuracy:		64.17 %
Epoch 22 of 100 took 0.603s
  training loss:		0.432178
  training r:		0.991808
  validation loss:		0.934750
  validation accuracy:		75.00 %
Epoch 23 of 100 took 0.611s
  training loss:		0.290691
  training r:		0.993677
  validation loss:		0.876234
  validation accuracy:		80.83 %
Epoch 24 of 100 took 0.599s
  training loss:		0.209635
  training r:		0.995120
  validation loss:		0.575647
  validation accuracy:		80.83 %
Epoch 25 of 100 took 0.619s
  training loss:		0.135912
  training r:		0.996157
  validation loss:		0.793162
  validation accuracy:		74.17 %
Epoch 26 of 100 took 0.622s
  training loss:		0.120412
  training r:		0.997132
  validation loss:		0.804836
  validation accuracy:		79.17 %
Epoch 27 of 100 took 0.599s
  training loss:		0.196941
  training r:		0.996766
  validation loss:		1.227039
  validation accuracy:		75.83 %
Epoch 28 of 100 took 0.639s
  training loss:		0.230403
  training r:		0.993997
  validation loss:		1.184120
  validation accuracy:		73.33 %
Epoch 29 of 100 took 0.606s
  training loss:		0.174618
  training r:		0.994810
  validation loss:		1.107069
  validation accuracy:		75.83 %
Epoch 30 of 100 took 0.599s
  training loss:		0.182296
  training r:		0.994604
  validation loss:		1.598830
  validation accuracy:		61.67 %
Epoch 31 of 100 took 0.612s
  training loss:		0.146981
  training r:		0.995663
  validation loss:		0.641509
  validation accuracy:		85.83 %
Epoch 32 of 100 took 0.595s
  training loss:		0.142484
  training r:		0.995397
  validation loss:		1.135181
  validation accuracy:		70.83 %
Epoch 33 of 100 took 0.614s
  training loss:		0.054018
  training r:		0.997790
  validation loss:		0.656667
  validation accuracy:		83.33 %
Epoch 34 of 100 took 0.596s
  training loss:		0.058213
  training r:		0.998472
  validation loss:		0.509355
  validation accuracy:		87.50 %
Epoch 35 of 100 took 0.615s
  training loss:		0.077174
  training r:		0.998492
  validation loss:		0.488710
  validation accuracy:		87.50 %
Epoch 36 of 100 took 0.611s
  training loss:		0.076664
  training r:		0.997970
  validation loss:		0.761307
  validation accuracy:		80.00 %
Epoch 37 of 100 took 0.596s
  training loss:		0.062769
  training r:		0.998051
  validation loss:		0.519400
  validation accuracy:		88.33 %
Epoch 38 of 100 took 0.611s
  training loss:		0.062021
  training r:		0.997783
  validation loss:		0.536904
  validation accuracy:		85.00 %
Epoch 39 of 100 took 0.611s
  training loss:		0.073336
  training r:		0.997348
  validation loss:		0.617450
  validation accuracy:		84.17 %
Epoch 40 of 100 took 0.615s
  training loss:		0.069972
  training r:		0.997896
  validation loss:		0.932478
  validation accuracy:		80.83 %
Epoch 41 of 100 took 0.611s
  training loss:		0.103067
  training r:		0.996504
  validation loss:		1.357362
  validation accuracy:		74.17 %
Epoch 42 of 100 took 0.623s
  training loss:		0.101668
  training r:		0.997149
  validation loss:		0.546535
  validation accuracy:		87.50 %
Epoch 43 of 100 took 0.595s
  training loss:		0.038384
  training r:		0.999465
  validation loss:		0.421563
  validation accuracy:		90.83 %
Epoch 44 of 100 took 0.635s
  training loss:		0.020232
  training r:		0.999839
  validation loss:		0.406400
  validation accuracy:		90.83 %
Epoch 45 of 100 took 0.598s
  training loss:		0.014548
  training r:		0.999945
  validation loss:		0.412303
  validation accuracy:		90.83 %
Epoch 46 of 100 took 0.611s
  training loss:		0.018021
  training r:		0.999962
  validation loss:		0.409721
  validation accuracy:		90.83 %
Epoch 47 of 100 took 0.595s
  training loss:		0.014258
  training r:		0.999956
  validation loss:		0.392999
  validation accuracy:		90.83 %
Epoch 48 of 100 took 0.627s
  training loss:		0.020258
  training r:		0.999948
  validation loss:		0.371266
  validation accuracy:		90.00 %
Epoch 49 of 100 took 0.619s
  training loss:		0.013808
  training r:		0.999954
  validation loss:		0.363721
  validation accuracy:		90.83 %
Epoch 50 of 100 took 0.607s
  training loss:		0.008339
  training r:		0.999969
  validation loss:		0.363544
  validation accuracy:		90.83 %
Epoch 51 of 100 took 0.620s
  training loss:		0.007008
  training r:		0.999985
  validation loss:		0.374323
  validation accuracy:		91.67 %
Epoch 52 of 100 took 0.605s
  training loss:		0.010895
  training r:		0.999977
  validation loss:		0.378761
  validation accuracy:		90.83 %
Epoch 53 of 100 took 0.596s
  training loss:		0.017099
  training r:		0.999959
  validation loss:		0.367872
  validation accuracy:		90.00 %
Epoch 54 of 100 took 0.627s
  training loss:		0.007335
  training r:		0.999979
  validation loss:		0.371026
  validation accuracy:		90.83 %
Epoch 55 of 100 took 0.603s
  training loss:		0.007919
  training r:		0.999984
  validation loss:		0.375818
  validation accuracy:		90.00 %
Epoch 56 of 100 took 0.599s
  training loss:		0.015216
  training r:		0.999964
  validation loss:		0.384335
  validation accuracy:		90.00 %
Epoch 57 of 100 took 0.615s
  training loss:		0.009437
  training r:		0.999963
  validation loss:		0.373136
  validation accuracy:		89.17 %
Epoch 58 of 100 took 0.599s
  training loss:		0.008062
  training r:		0.999978
  validation loss:		0.369890
  validation accuracy:		90.83 %
Epoch 59 of 100 took 0.603s
  training loss:		0.008416
  training r:		0.999983
  validation loss:		0.360408
  validation accuracy:		90.83 %
Epoch 60 of 100 took 0.611s
  training loss:		0.013879
  training r:		0.999967
  validation loss:		0.359995
  validation accuracy:		90.83 %
Epoch 61 of 100 took 0.603s
  training loss:		0.007000
  training r:		0.999960
  validation loss:		0.368185
  validation accuracy:		91.67 %
Epoch 62 of 100 took 0.599s
  training loss:		0.007191
  training r:		0.999988
  validation loss:		0.376292
  validation accuracy:		92.50 %
Epoch 63 of 100 took 0.639s
  training loss:		0.021877
  training r:		0.999993
  validation loss:		0.375422
  validation accuracy:		92.50 %
Epoch 64 of 100 took 0.623s
  training loss:		0.006877
  training r:		0.999998
  validation loss:		0.372623
  validation accuracy:		91.67 %
Epoch 65 of 100 took 0.607s
  training loss:		0.012518
  training r:		0.999998
  validation loss:		0.372117
  validation accuracy:		92.50 %
Epoch 66 of 100 took 0.596s
  training loss:		0.008736
  training r:		0.999998
  validation loss:		0.371306
  validation accuracy:		92.50 %
Epoch 67 of 100 took 0.615s
  training loss:		0.007178
  training r:		0.999996
  validation loss:		0.381978
  validation accuracy:		91.67 %
Epoch 68 of 100 took 0.611s
  training loss:		0.012984
  training r:		0.999995
  validation loss:		0.371998
  validation accuracy:		91.67 %
Epoch 69 of 100 took 0.635s
  training loss:		0.007849
  training r:		0.999997
  validation loss:		0.369431
  validation accuracy:		91.67 %
Epoch 70 of 100 took 0.607s
  training loss:		0.008287
  training r:		0.999996
  validation loss:		0.369756
  validation accuracy:		92.50 %
Epoch 71 of 100 took 0.620s
  training loss:		0.009312
  training r:		0.999996
  validation loss:		0.377257
  validation accuracy:		91.67 %
Epoch 72 of 100 took 0.603s
  training loss:		0.008497
  training r:		0.999993
  validation loss:		0.365225
  validation accuracy:		90.83 %
Epoch 73 of 100 took 0.612s
  training loss:		0.008000
  training r:		0.999995
  validation loss:		0.360261
  validation accuracy:		92.50 %
Epoch 74 of 100 took 0.599s
  training loss:		0.006842
  training r:		0.999993
  validation loss:		0.364773
  validation accuracy:		91.67 %
Epoch 75 of 100 took 0.615s
  training loss:		0.010870
  training r:		0.999996
  validation loss:		0.366464
  validation accuracy:		92.50 %
Epoch 76 of 100 took 0.610s
  training loss:		0.010066
  training r:		0.999992
  validation loss:		0.362028
  validation accuracy:		92.50 %
Epoch 77 of 100 took 0.619s
  training loss:		0.006243
  training r:		0.999995
  validation loss:		0.366453
  validation accuracy:		92.50 %
Epoch 78 of 100 took 0.605s
  training loss:		0.010317
  training r:		0.999992
  validation loss:		0.373120
  validation accuracy:		91.67 %
Epoch 79 of 100 took 0.612s
  training loss:		0.005949
  training r:		0.999995
  validation loss:		0.360269
  validation accuracy:		92.50 %
Epoch 80 of 100 took 0.612s
  training loss:		0.008993
  training r:		0.999994
  validation loss:		0.354884
  validation accuracy:		92.50 %
Epoch 81 of 100 took 0.605s
  training loss:		0.010151
  training r:		0.999987
  validation loss:		0.359478
  validation accuracy:		90.83 %
Epoch 82 of 100 took 0.612s
  training loss:		0.006745
  training r:		0.999991
  validation loss:		0.365219
  validation accuracy:		91.67 %
Epoch 83 of 100 took 0.626s
  training loss:		0.006459
  training r:		0.999995
  validation loss:		0.365635
  validation accuracy:		92.50 %
Epoch 84 of 100 took 0.601s
  training loss:		0.005603
  training r:		0.999996
  validation loss:		0.364156
  validation accuracy:		91.67 %
Epoch 85 of 100 took 0.611s
  training loss:		0.008757
  training r:		0.999993
  validation loss:		0.368112
  validation accuracy:		91.67 %
Epoch 86 of 100 took 0.599s
  training loss:		0.007056
  training r:		0.999994
  validation loss:		0.369029
  validation accuracy:		90.83 %
Epoch 87 of 100 took 0.599s
  training loss:		0.006482
  training r:		0.999994
  validation loss:		0.368279
  validation accuracy:		91.67 %
Epoch 88 of 100 took 0.607s
  training loss:		0.006111
  training r:		0.999995
  validation loss:		0.352016
  validation accuracy:		91.67 %
Epoch 89 of 100 took 0.615s
  training loss:		0.011562
  training r:		0.999985
  validation loss:		0.360453
  validation accuracy:		91.67 %
Epoch 90 of 100 took 0.607s
  training loss:		0.007211
  training r:		0.999988
  validation loss:		0.361535
  validation accuracy:		91.67 %
Epoch 91 of 100 took 0.615s
  training loss:		0.011478
  training r:		0.999992
  validation loss:		0.344490
  validation accuracy:		92.50 %
Epoch 92 of 100 took 0.611s
  training loss:		0.006488
  training r:		0.999994
  validation loss:		0.357300
  validation accuracy:		91.67 %
Epoch 93 of 100 took 0.614s
  training loss:		0.011545
  training r:		0.999988
  validation loss:		0.353355
  validation accuracy:		92.50 %
Epoch 94 of 100 took 0.611s
  training loss:		0.006045
  training r:		0.999990
  validation loss:		0.358639
  validation accuracy:		90.83 %
Epoch 95 of 100 took 0.595s
  training loss:		0.011724
  training r:		0.999991
  validation loss:		0.358744
  validation accuracy:		90.83 %
Epoch 96 of 100 took 0.602s
  training loss:		0.006904
  training r:		0.999986
  validation loss:		0.358915
  validation accuracy:		91.67 %
Epoch 97 of 100 took 0.599s
  training loss:		0.004311
  training r:		0.999995
  validation loss:		0.354902
  validation accuracy:		92.50 %
Epoch 98 of 100 took 0.595s
  training loss:		0.008324
  training r:		0.999992
  validation loss:		0.360209
  validation accuracy:		91.67 %
Epoch 99 of 100 took 0.607s
  training loss:		0.015305
  training r:		0.999981
  validation loss:		0.363399
  validation accuracy:		92.50 %
Epoch 100 of 100 took 0.598s
  training loss:		0.009091
  training r:		0.999989
  validation loss:		0.348730
  validation accuracy:		91.67 %
Final results:
  test loss:			0.348730
  test accuracy:		91.67 %
tensor([ 0,  0,  0,  1,  1,  1,  2,  2, 22,  3, 19,  3,  4,  4, 17,  5,  5,  5,
         6,  6,  6,  7,  7,  7,  8,  8,  8,  9,  9,  7, 10, 10, 10, 11, 11, 11,
        12, 12, 12, 13], device='cuda:0')
[ 0  0  0  1  1  1  2  2  2  3  3  3  4  4  4  5  5  5  6  6  6  7  7  7
  8  8  8  9  9  9 10 10 10 11 11 11 12 12 12 13 13 13 14 14 14 15 15 15
 16 16 16 17 17 17 18 18 18 19 19 19 20 20 20 21 21 21 22 22 22 23 23 23
 24 24 24 25 25 25 26 26 26 27 27 27 28 28 28 29 29 29 30 30 30 31 31 31
 32 32 32 33 33 33 34 34 34 35 35 35 36 36 36 37 37 37 38 38 38 39 39 39]
tensor([13, 13, 14, 14, 14, 15, 15, 15, 16, 16, 16, 17, 17, 17, 18, 18, 18, 19,
        19, 19, 28, 20, 20, 21, 21, 21, 22, 11, 22, 23, 23, 23, 24, 24, 24, 25,
        25, 25, 26, 26], device='cuda:0')
[ 0  0  0  1  1  1  2  2  2  3  3  3  4  4  4  5  5  5  6  6  6  7  7  7
  8  8  8  9  9  9 10 10 10 11 11 11 12 12 12 13 13 13 14 14 14 15 15 15
 16 16 16 17 17 17 18 18 18 19 19 19 20 20 20 21 21 21 22 22 22 23 23 23
 24 24 24 25 25 25 26 26 26 27 27 27 28 28 28 29 29 29 30 30 30 31 31 31
 32 32 32 33 33 33 34 34 34 35 35 35 36 36 36 37 37 37 38 38 38 39 39 39]
tensor([26, 27, 27, 27, 28, 38, 28, 29, 29, 29, 30, 30, 30, 31,  6, 31, 32, 32,
        32, 33, 33, 33, 34, 34, 34, 35,  1, 35, 36, 36, 36, 37, 37, 37, 38, 38,
        38, 39,  7, 39], device='cuda:0')
[ 0  0  0  1  1  1  2  2  2  3  3  3  4  4  4  5  5  5  6  6  6  7  7  7
  8  8  8  9  9  9 10 10 10 11 11 11 12 12 12 13 13 13 14 14 14 15 15 15
 16 16 16 17 17 17 18 18 18 19 19 19 20 20 20 21 21 21 22 22 22 23 23 23
 24 24 24 25 25 25 26 26 26 27 27 27 28 28 28 29 29 29 30 30 30 31 31 31
 32 32 32 33 33 33 34 34 34 35 35 35 36 36 36 37 37 37 38 38 38 39 39 39]
0.9166666666666666
