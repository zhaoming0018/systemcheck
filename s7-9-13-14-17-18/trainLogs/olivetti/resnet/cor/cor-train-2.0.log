Loading data...
Raw data shape (280, 32, 32)
Number of training data, output: 560, 40...
Building model and compiling functions...
Number of parameters in model: 466104
Number of data correlated: 455
Number of params greater than targets
Starting training...
train.py:71: DeprecationWarning: This function is deprecated. Please call randint(0, 8 + 1) instead
  crops = np.random.random_integers(0, high=8, size=(batchsize, 2))
Epoch 1 of 100 took 1.567s
  training loss:		4.393363
  training r:		0.004532
  validation loss:		4.316815
  validation accuracy:		4.17 %
Epoch 2 of 100 took 1.136s
  training loss:		3.507857
  training r:		0.018424
  validation loss:		3.319256
  validation accuracy:		11.67 %
Epoch 3 of 100 took 1.133s
  training loss:		3.071999
  training r:		0.034524
  validation loss:		3.287409
  validation accuracy:		14.17 %
Epoch 4 of 100 took 1.143s
  training loss:		2.716868
  training r:		0.051384
  validation loss:		2.927795
  validation accuracy:		14.17 %
Epoch 5 of 100 took 0.970s
  training loss:		2.336885
  training r:		0.068479
  validation loss:		2.292664
  validation accuracy:		31.67 %
Epoch 6 of 100 took 1.145s
  training loss:		2.059007
  training r:		0.085038
  validation loss:		2.778201
  validation accuracy:		21.67 %
Epoch 7 of 100 took 1.105s
  training loss:		1.983801
  training r:		0.101065
  validation loss:		2.627354
  validation accuracy:		27.50 %
Epoch 8 of 100 took 1.119s
  training loss:		1.595886
  training r:		0.117097
  validation loss:		2.484305
  validation accuracy:		32.50 %
Epoch 9 of 100 took 1.116s
  training loss:		1.418341
  training r:		0.132802
  validation loss:		2.458551
  validation accuracy:		30.83 %
Epoch 10 of 100 took 1.123s
  training loss:		1.242987
  training r:		0.148508
  validation loss:		3.133627
  validation accuracy:		30.83 %
Epoch 11 of 100 took 1.131s
  training loss:		0.920686
  training r:		0.163277
  validation loss:		1.961838
  validation accuracy:		51.67 %
Epoch 12 of 100 took 1.087s
  training loss:		0.585398
  training r:		0.177962
  validation loss:		3.598024
  validation accuracy:		34.17 %
Epoch 13 of 100 took 1.052s
  training loss:		0.500026
  training r:		0.192030
  validation loss:		1.524403
  validation accuracy:		64.17 %
Epoch 14 of 100 took 1.067s
  training loss:		0.410176
  training r:		0.206061
  validation loss:		2.805483
  validation accuracy:		45.00 %
Epoch 15 of 100 took 0.823s
  training loss:		0.300925
  training r:		0.220430
  validation loss:		1.204904
  validation accuracy:		67.50 %
Epoch 16 of 100 took 0.860s
  training loss:		0.023351
  training r:		0.234098
  validation loss:		1.065680
  validation accuracy:		60.83 %
Epoch 17 of 100 took 0.824s
  training loss:		-0.138327
  training r:		0.248028
  validation loss:		0.906051
  validation accuracy:		77.50 %
Epoch 18 of 100 took 0.750s
  training loss:		-0.232458
  training r:		0.261726
  validation loss:		1.198024
  validation accuracy:		73.33 %
Epoch 19 of 100 took 0.784s
  training loss:		-0.278421
  training r:		0.275309
  validation loss:		1.636588
  validation accuracy:		70.00 %
Epoch 20 of 100 took 0.755s
  training loss:		-0.186816
  training r:		0.288675
  validation loss:		2.093711
  validation accuracy:		52.50 %
Epoch 21 of 100 took 0.884s
  training loss:		-0.285919
  training r:		0.300664
  validation loss:		1.159180
  validation accuracy:		67.50 %
Epoch 22 of 100 took 0.775s
  training loss:		-0.305575
  training r:		0.312231
  validation loss:		1.264576
  validation accuracy:		64.17 %
Epoch 23 of 100 took 0.731s
  training loss:		-0.353646
  training r:		0.324389
  validation loss:		0.865112
  validation accuracy:		75.83 %
Epoch 24 of 100 took 0.724s
  training loss:		-0.470319
  training r:		0.336895
  validation loss:		0.873980
  validation accuracy:		75.00 %
Epoch 25 of 100 took 0.688s
  training loss:		-0.453168
  training r:		0.348900
  validation loss:		1.586339
  validation accuracy:		70.83 %
Epoch 26 of 100 took 0.743s
  training loss:		-0.492657
  training r:		0.360097
  validation loss:		0.873472
  validation accuracy:		72.50 %
Epoch 27 of 100 took 0.676s
  training loss:		-0.517854
  training r:		0.371614
  validation loss:		0.858057
  validation accuracy:		77.50 %
Epoch 28 of 100 took 0.727s
  training loss:		-0.540473
  training r:		0.382407
  validation loss:		1.008637
  validation accuracy:		78.33 %
Epoch 29 of 100 took 0.795s
  training loss:		-0.607217
  training r:		0.394047
  validation loss:		1.266924
  validation accuracy:		76.67 %
Epoch 30 of 100 took 0.723s
  training loss:		-0.696664
  training r:		0.405451
  validation loss:		0.479494
  validation accuracy:		85.83 %
Epoch 31 of 100 took 0.760s
  training loss:		-0.718194
  training r:		0.416758
  validation loss:		0.553596
  validation accuracy:		81.67 %
Epoch 32 of 100 took 0.759s
  training loss:		-0.712531
  training r:		0.427635
  validation loss:		1.442973
  validation accuracy:		71.67 %
Epoch 33 of 100 took 0.771s
  training loss:		-0.777439
  training r:		0.438382
  validation loss:		0.775640
  validation accuracy:		81.67 %
Epoch 34 of 100 took 0.787s
  training loss:		-0.816462
  training r:		0.448972
  validation loss:		0.676896
  validation accuracy:		82.50 %
Epoch 35 of 100 took 0.791s
  training loss:		-0.851145
  training r:		0.459864
  validation loss:		0.549900
  validation accuracy:		82.50 %
Epoch 36 of 100 took 0.699s
  training loss:		-0.892240
  training r:		0.471256
  validation loss:		0.445899
  validation accuracy:		88.33 %
Epoch 37 of 100 took 0.632s
  training loss:		-0.941590
  training r:		0.482510
  validation loss:		0.365336
  validation accuracy:		90.83 %
Epoch 38 of 100 took 0.795s
  training loss:		-0.964438
  training r:		0.493678
  validation loss:		0.389402
  validation accuracy:		90.83 %
Epoch 39 of 100 took 0.783s
  training loss:		-0.983418
  training r:		0.504771
  validation loss:		0.447120
  validation accuracy:		88.33 %
Epoch 40 of 100 took 0.707s
  training loss:		-1.004555
  training r:		0.515930
  validation loss:		0.500809
  validation accuracy:		87.50 %
Epoch 41 of 100 took 0.747s
  training loss:		-1.026680
  training r:		0.526847
  validation loss:		0.304953
  validation accuracy:		89.17 %
Epoch 42 of 100 took 0.739s
  training loss:		-1.041838
  training r:		0.533035
  validation loss:		0.313098
  validation accuracy:		90.83 %
Epoch 43 of 100 took 0.783s
  training loss:		-1.057115
  training r:		0.534090
  validation loss:		0.310259
  validation accuracy:		91.67 %
Epoch 44 of 100 took 0.922s
  training loss:		-1.062075
  training r:		0.535157
  validation loss:		0.318193
  validation accuracy:		92.50 %
Epoch 45 of 100 took 0.911s
  training loss:		-1.064396
  training r:		0.536235
  validation loss:		0.324490
  validation accuracy:		93.33 %
Epoch 46 of 100 took 0.811s
  training loss:		-1.066149
  training r:		0.537320
  validation loss:		0.319635
  validation accuracy:		93.33 %
Epoch 47 of 100 took 0.699s
  training loss:		-1.068028
  training r:		0.538404
  validation loss:		0.327481
  validation accuracy:		91.67 %
Epoch 48 of 100 took 0.772s
  training loss:		-1.064352
  training r:		0.539490
  validation loss:		0.341908
  validation accuracy:		91.67 %
Epoch 49 of 100 took 0.747s
  training loss:		-1.057851
  training r:		0.540573
  validation loss:		0.335580
  validation accuracy:		90.83 %
Epoch 50 of 100 took 0.763s
  training loss:		-1.065737
  training r:		0.541653
  validation loss:		0.324319
  validation accuracy:		92.50 %
Epoch 51 of 100 took 0.768s
  training loss:		-1.077720
  training r:		0.542731
  validation loss:		0.329699
  validation accuracy:		92.50 %
Epoch 52 of 100 took 0.800s
  training loss:		-1.075961
  training r:		0.543806
  validation loss:		0.340024
  validation accuracy:		93.33 %
Epoch 53 of 100 took 0.691s
  training loss:		-1.082666
  training r:		0.544878
  validation loss:		0.334750
  validation accuracy:		91.67 %
Epoch 54 of 100 took 0.771s
  training loss:		-1.079654
  training r:		0.545951
  validation loss:		0.347207
  validation accuracy:		91.67 %
Epoch 55 of 100 took 0.771s
  training loss:		-1.086199
  training r:		0.547012
  validation loss:		0.315350
  validation accuracy:		91.67 %
Epoch 56 of 100 took 0.652s
  training loss:		-1.087899
  training r:		0.548088
  validation loss:		0.317159
  validation accuracy:		92.50 %
Epoch 57 of 100 took 0.659s
  training loss:		-1.093088
  training r:		0.549162
  validation loss:		0.327158
  validation accuracy:		91.67 %
Epoch 58 of 100 took 0.851s
  training loss:		-1.095370
  training r:		0.550237
  validation loss:		0.331379
  validation accuracy:		91.67 %
Epoch 59 of 100 took 0.759s
  training loss:		-1.095495
  training r:		0.551307
  validation loss:		0.325427
  validation accuracy:		90.83 %
Epoch 60 of 100 took 0.776s
  training loss:		-1.093524
  training r:		0.552371
  validation loss:		0.325385
  validation accuracy:		90.83 %
Epoch 61 of 100 took 1.050s
  training loss:		-1.100389
  training r:		0.553439
  validation loss:		0.342632
  validation accuracy:		91.67 %
Epoch 62 of 100 took 1.075s
  training loss:		-1.097982
  training r:		0.554062
  validation loss:		0.332549
  validation accuracy:		90.83 %
Epoch 63 of 100 took 1.051s
  training loss:		-1.104015
  training r:		0.554169
  validation loss:		0.339763
  validation accuracy:		91.67 %
Epoch 64 of 100 took 1.079s
  training loss:		-1.103739
  training r:		0.554276
  validation loss:		0.336257
  validation accuracy:		91.67 %
Epoch 65 of 100 took 1.100s
  training loss:		-1.102320
  training r:		0.554383
  validation loss:		0.331262
  validation accuracy:		90.83 %
Epoch 66 of 100 took 1.200s
  training loss:		-1.101172
  training r:		0.554490
  validation loss:		0.332702
  validation accuracy:		90.83 %
Epoch 67 of 100 took 1.109s
  training loss:		-1.104520
  training r:		0.554596
  validation loss:		0.335240
  validation accuracy:		90.83 %
Epoch 68 of 100 took 1.087s
  training loss:		-1.102536
  training r:		0.554703
  validation loss:		0.322758
  validation accuracy:		90.83 %
Epoch 69 of 100 took 1.068s
  training loss:		-1.099683
  training r:		0.554810
  validation loss:		0.338602
  validation accuracy:		90.83 %
Epoch 70 of 100 took 1.063s
  training loss:		-1.104524
  training r:		0.554917
  validation loss:		0.332734
  validation accuracy:		91.67 %
Epoch 71 of 100 took 1.083s
  training loss:		-1.103337
  training r:		0.555023
  validation loss:		0.326219
  validation accuracy:		90.83 %
Epoch 72 of 100 took 1.047s
  training loss:		-1.100004
  training r:		0.555129
  validation loss:		0.321526
  validation accuracy:		90.83 %
Epoch 73 of 100 took 1.075s
  training loss:		-1.103012
  training r:		0.555235
  validation loss:		0.339319
  validation accuracy:		90.83 %
Epoch 74 of 100 took 1.087s
  training loss:		-1.104271
  training r:		0.555340
  validation loss:		0.329677
  validation accuracy:		91.67 %
Epoch 75 of 100 took 1.084s
  training loss:		-1.105332
  training r:		0.555446
  validation loss:		0.327187
  validation accuracy:		90.83 %
Epoch 76 of 100 took 0.903s
  training loss:		-1.104891
  training r:		0.555553
  validation loss:		0.325863
  validation accuracy:		91.67 %
Epoch 77 of 100 took 0.839s
  training loss:		-1.106275
  training r:		0.555659
  validation loss:		0.342046
  validation accuracy:		91.67 %
Epoch 78 of 100 took 0.839s
  training loss:		-1.103330
  training r:		0.555765
  validation loss:		0.334983
  validation accuracy:		91.67 %
Epoch 79 of 100 took 0.778s
  training loss:		-1.106284
  training r:		0.555871
  validation loss:		0.338253
  validation accuracy:		91.67 %
Epoch 80 of 100 took 0.780s
  training loss:		-1.103918
  training r:		0.555977
  validation loss:		0.332850
  validation accuracy:		91.67 %
Epoch 81 of 100 took 0.796s
  training loss:		-1.106436
  training r:		0.556083
  validation loss:		0.327244
  validation accuracy:		90.83 %
Epoch 82 of 100 took 0.823s
  training loss:		-1.107617
  training r:		0.556190
  validation loss:		0.329215
  validation accuracy:		90.83 %
Epoch 83 of 100 took 0.755s
  training loss:		-1.106449
  training r:		0.556296
  validation loss:		0.333201
  validation accuracy:		91.67 %
Epoch 84 of 100 took 0.876s
  training loss:		-1.106354
  training r:		0.556403
  validation loss:		0.327008
  validation accuracy:		91.67 %
Epoch 85 of 100 took 0.711s
  training loss:		-1.107996
  training r:		0.556510
  validation loss:		0.324550
  validation accuracy:		91.67 %
Epoch 86 of 100 took 0.783s
  training loss:		-1.106725
  training r:		0.556616
  validation loss:		0.328958
  validation accuracy:		90.83 %
Epoch 87 of 100 took 0.847s
  training loss:		-1.108735
  training r:		0.556723
  validation loss:		0.326355
  validation accuracy:		90.83 %
Epoch 88 of 100 took 0.783s
  training loss:		-1.107180
  training r:		0.556829
  validation loss:		0.327880
  validation accuracy:		91.67 %
Epoch 89 of 100 took 0.775s
  training loss:		-1.104684
  training r:		0.556936
  validation loss:		0.322634
  validation accuracy:		90.83 %
Epoch 90 of 100 took 0.795s
  training loss:		-1.105716
  training r:		0.557042
  validation loss:		0.330664
  validation accuracy:		90.83 %
Epoch 91 of 100 took 0.796s
  training loss:		-1.104221
  training r:		0.557149
  validation loss:		0.334400
  validation accuracy:		90.83 %
Epoch 92 of 100 took 0.864s
  training loss:		-1.105013
  training r:		0.557257
  validation loss:		0.331855
  validation accuracy:		90.83 %
Epoch 93 of 100 took 0.807s
  training loss:		-1.108924
  training r:		0.557363
  validation loss:		0.329519
  validation accuracy:		91.67 %
Epoch 94 of 100 took 0.844s
  training loss:		-1.107042
  training r:		0.557469
  validation loss:		0.326180
  validation accuracy:		91.67 %
Epoch 95 of 100 took 0.790s
  training loss:		-1.101623
  training r:		0.557574
  validation loss:		0.324337
  validation accuracy:		90.83 %
Epoch 96 of 100 took 0.760s
  training loss:		-1.108139
  training r:		0.557678
  validation loss:		0.337817
  validation accuracy:		91.67 %
Epoch 97 of 100 took 0.847s
  training loss:		-1.107841
  training r:		0.557784
  validation loss:		0.331934
  validation accuracy:		91.67 %
Epoch 98 of 100 took 0.803s
  training loss:		-1.105406
  training r:		0.557890
  validation loss:		0.320947
  validation accuracy:		91.67 %
Epoch 99 of 100 took 0.791s
  training loss:		-1.107722
  training r:		0.557997
  validation loss:		0.328497
  validation accuracy:		91.67 %
Epoch 100 of 100 took 0.784s
  training loss:		-1.111166
  training r:		0.558104
  validation loss:		0.332688
  validation accuracy:		90.83 %
Final results:
  test loss:			0.332688
  test accuracy:		90.83 %
tensor([ 0,  0,  0,  1,  1,  1,  2,  3, 22,  3, 18,  3,  4,  4, 39,  5,  5,  5,
         6,  6,  6,  7,  7,  7,  8,  8,  8,  9,  9,  7, 10, 10, 10, 11, 11, 11,
        12, 12, 12, 13], device='cuda:0')
[ 0  0  0  1  1  1  2  2  2  3  3  3  4  4  4  5  5  5  6  6  6  7  7  7
  8  8  8  9  9  9 10 10 10 11 11 11 12 12 12 13 13 13 14 14 14 15 15 15
 16 16 16 17 17 17 18 18 18 19 19 19 20 20 20 21 21 21 22 22 22 23 23 23
 24 24 24 25 25 25 26 26 26 27 27 27 28 28 28 29 29 29 30 30 30 31 31 31
 32 32 32 33 33 33 34 34 34 35 35 35 36 36 36 37 37 37 38 38 38 39 39 39]
tensor([13, 13, 14, 14, 14, 15, 15, 15, 16, 16, 16, 17, 17, 17, 18, 18, 18, 19,
        19, 19, 28, 28, 20, 21, 21, 21, 22, 12, 37, 23, 23, 23, 24, 24, 24, 25,
        25, 25, 26, 26], device='cuda:0')
[ 0  0  0  1  1  1  2  2  2  3  3  3  4  4  4  5  5  5  6  6  6  7  7  7
  8  8  8  9  9  9 10 10 10 11 11 11 12 12 12 13 13 13 14 14 14 15 15 15
 16 16 16 17 17 17 18 18 18 19 19 19 20 20 20 21 21 21 22 22 22 23 23 23
 24 24 24 25 25 25 26 26 26 27 27 27 28 28 28 29 29 29 30 30 30 31 31 31
 32 32 32 33 33 33 34 34 34 35 35 35 36 36 36 37 37 37 38 38 38 39 39 39]
tensor([26, 27, 27, 27, 28, 28, 28, 29, 29, 29, 30, 30, 30, 31,  6, 31, 32, 32,
        32, 33, 33, 33, 34, 34, 34, 35,  1, 35, 36, 36, 36, 37, 37, 37, 38, 38,
        38, 39, 39, 39], device='cuda:0')
[ 0  0  0  1  1  1  2  2  2  3  3  3  4  4  4  5  5  5  6  6  6  7  7  7
  8  8  8  9  9  9 10 10 10 11 11 11 12 12 12 13 13 13 14 14 14 15 15 15
 16 16 16 17 17 17 18 18 18 19 19 19 20 20 20 21 21 21 22 22 22 23 23 23
 24 24 24 25 25 25 26 26 26 27 27 27 28 28 28 29 29 29 30 30 30 31 31 31
 32 32 32 33 33 33 34 34 34 35 35 35 36 36 36 37 37 37 38 38 38 39 39 39]
0.9083333333333334
