Loading data...
Raw data shape (280, 32, 32)
Number of training data, output: 560, 40...
Building model and compiling functions...
Number of parameters in model: 11186536
Number of data correlated: 10924
Number of params greater than targets
Starting training...
train.py:71: DeprecationWarning: This function is deprecated. Please call randint(0, 8 + 1) instead
  crops = np.random.random_integers(0, high=8, size=(batchsize, 2))
Epoch 1 of 100 took 2.688s
  training loss:		2.869791
  training r:		-0.114538
  validation loss:		4.064835
  validation accuracy:		2.50 %
Epoch 2 of 100 took 0.929s
  training loss:		-0.574544
  training r:		-0.490466
  validation loss:		4.493272
  validation accuracy:		8.33 %
Epoch 3 of 100 took 0.886s
  training loss:		-3.341183
  training r:		-0.766074
  validation loss:		4.630233
  validation accuracy:		15.00 %
Epoch 4 of 100 took 0.862s
  training loss:		-4.399401
  training r:		-0.887796
  validation loss:		3.801812
  validation accuracy:		19.17 %
Epoch 5 of 100 took 0.902s
  training loss:		-5.236247
  training r:		-0.937339
  validation loss:		5.454719
  validation accuracy:		16.67 %
Epoch 6 of 100 took 0.918s
  training loss:		-5.591918
  training r:		-0.955110
  validation loss:		3.422499
  validation accuracy:		21.67 %
Epoch 7 of 100 took 0.852s
  training loss:		-5.769258
  training r:		-0.964421
  validation loss:		2.598207
  validation accuracy:		35.83 %
Epoch 8 of 100 took 0.833s
  training loss:		-5.915143
  training r:		-0.970542
  validation loss:		3.018658
  validation accuracy:		27.50 %
Epoch 9 of 100 took 0.871s
  training loss:		-6.140264
  training r:		-0.974246
  validation loss:		2.514020
  validation accuracy:		34.17 %
Epoch 10 of 100 took 0.913s
  training loss:		-6.375405
  training r:		-0.974576
  validation loss:		2.815610
  validation accuracy:		39.17 %
Epoch 11 of 100 took 0.811s
  training loss:		-6.530676
  training r:		-0.975553
  validation loss:		4.165753
  validation accuracy:		20.00 %
Epoch 12 of 100 took 0.847s
  training loss:		-6.779019
  training r:		-0.979299
  validation loss:		1.284085
  validation accuracy:		59.17 %
Epoch 13 of 100 took 0.863s
  training loss:		-6.864756
  training r:		-0.981557
  validation loss:		1.949816
  validation accuracy:		52.50 %
Epoch 14 of 100 took 0.887s
  training loss:		-6.954274
  training r:		-0.982074
  validation loss:		1.361689
  validation accuracy:		60.83 %
Epoch 15 of 100 took 0.815s
  training loss:		-7.082693
  training r:		-0.982348
  validation loss:		7.956880
  validation accuracy:		25.00 %
Epoch 16 of 100 took 0.840s
  training loss:		-6.941278
  training r:		-0.979095
  validation loss:		2.490104
  validation accuracy:		45.83 %
Epoch 17 of 100 took 0.868s
  training loss:		-6.936800
  training r:		-0.977149
  validation loss:		1.801738
  validation accuracy:		58.33 %
Epoch 18 of 100 took 0.900s
  training loss:		-7.115121
  training r:		-0.979284
  validation loss:		5.354047
  validation accuracy:		28.33 %
Epoch 19 of 100 took 0.849s
  training loss:		-7.201870
  training r:		-0.981827
  validation loss:		1.164170
  validation accuracy:		61.67 %
Epoch 20 of 100 took 0.840s
  training loss:		-7.335790
  training r:		-0.982881
  validation loss:		1.047631
  validation accuracy:		68.33 %
Epoch 21 of 100 took 0.802s
  training loss:		-7.404121
  training r:		-0.983860
  validation loss:		1.229560
  validation accuracy:		69.17 %
Epoch 22 of 100 took 0.876s
  training loss:		-7.305964
  training r:		-0.985544
  validation loss:		1.982611
  validation accuracy:		62.50 %
Epoch 23 of 100 took 0.771s
  training loss:		-7.248309
  training r:		-0.985586
  validation loss:		1.749191
  validation accuracy:		60.00 %
Epoch 24 of 100 took 0.831s
  training loss:		-7.308272
  training r:		-0.984648
  validation loss:		3.560669
  validation accuracy:		37.50 %
Epoch 25 of 100 took 0.798s
  training loss:		-7.262034
  training r:		-0.983444
  validation loss:		1.567943
  validation accuracy:		69.17 %
Epoch 26 of 100 took 0.774s
  training loss:		-7.375401
  training r:		-0.982646
  validation loss:		1.093370
  validation accuracy:		66.67 %
Epoch 27 of 100 took 0.792s
  training loss:		-7.416758
  training r:		-0.983943
  validation loss:		1.101755
  validation accuracy:		72.50 %
Epoch 28 of 100 took 0.823s
  training loss:		-7.532277
  training r:		-0.985808
  validation loss:		1.708001
  validation accuracy:		54.17 %
Epoch 29 of 100 took 0.939s
  training loss:		-7.657677
  training r:		-0.987401
  validation loss:		1.680554
  validation accuracy:		65.00 %
Epoch 30 of 100 took 0.849s
  training loss:		-7.688440
  training r:		-0.988329
  validation loss:		1.077533
  validation accuracy:		72.50 %
Epoch 31 of 100 took 0.907s
  training loss:		-7.686564
  training r:		-0.989390
  validation loss:		1.111839
  validation accuracy:		73.33 %
Epoch 32 of 100 took 0.925s
  training loss:		-7.718997
  training r:		-0.989630
  validation loss:		4.146961
  validation accuracy:		48.33 %
Epoch 33 of 100 took 0.863s
  training loss:		-7.730696
  training r:		-0.988571
  validation loss:		1.198059
  validation accuracy:		76.67 %
Epoch 34 of 100 took 0.846s
  training loss:		-7.729169
  training r:		-0.988833
  validation loss:		2.110179
  validation accuracy:		64.17 %
Epoch 35 of 100 took 0.824s
  training loss:		-7.588200
  training r:		-0.988155
  validation loss:		1.434952
  validation accuracy:		75.83 %
Epoch 36 of 100 took 0.992s
  training loss:		-7.650277
  training r:		-0.986208
  validation loss:		1.865739
  validation accuracy:		54.17 %
Epoch 37 of 100 took 0.900s
  training loss:		-7.763975
  training r:		-0.986332
  validation loss:		2.550728
  validation accuracy:		43.33 %
Epoch 38 of 100 took 0.907s
  training loss:		-7.682315
  training r:		-0.987777
  validation loss:		1.239073
  validation accuracy:		68.33 %
Epoch 39 of 100 took 0.896s
  training loss:		-7.698422
  training r:		-0.988484
  validation loss:		1.159988
  validation accuracy:		74.17 %
Epoch 40 of 100 took 0.877s
  training loss:		-7.614637
  training r:		-0.988470
  validation loss:		5.090127
  validation accuracy:		50.83 %
Epoch 41 of 100 took 0.852s
  training loss:		-7.713682
  training r:		-0.984398
  validation loss:		2.774404
  validation accuracy:		60.83 %
Epoch 42 of 100 took 0.895s
  training loss:		-7.737747
  training r:		-0.983483
  validation loss:		1.030366
  validation accuracy:		79.17 %
Epoch 43 of 100 took 0.909s
  training loss:		-7.809861
  training r:		-0.983866
  validation loss:		0.570566
  validation accuracy:		87.50 %
Epoch 44 of 100 took 0.845s
  training loss:		-7.854835
  training r:		-0.984365
  validation loss:		0.548519
  validation accuracy:		85.83 %
Epoch 45 of 100 took 0.876s
  training loss:		-7.857611
  training r:		-0.984923
  validation loss:		0.555056
  validation accuracy:		86.67 %
Epoch 46 of 100 took 0.898s
  training loss:		-7.862720
  training r:		-0.985487
  validation loss:		0.532749
  validation accuracy:		86.67 %
Epoch 47 of 100 took 0.981s
  training loss:		-7.866793
  training r:		-0.986017
  validation loss:		0.489464
  validation accuracy:		87.50 %
Epoch 48 of 100 took 0.906s
  training loss:		-7.848944
  training r:		-0.986519
  validation loss:		0.517804
  validation accuracy:		87.50 %
Epoch 49 of 100 took 0.829s
  training loss:		-7.870247
  training r:		-0.987006
  validation loss:		0.502747
  validation accuracy:		87.50 %
Epoch 50 of 100 took 0.906s
  training loss:		-7.872518
  training r:		-0.987489
  validation loss:		0.499776
  validation accuracy:		87.50 %
Epoch 51 of 100 took 0.843s
  training loss:		-7.879297
  training r:		-0.987950
  validation loss:		0.487800
  validation accuracy:		88.33 %
Epoch 52 of 100 took 0.811s
  training loss:		-7.894971
  training r:		-0.988401
  validation loss:		0.504580
  validation accuracy:		88.33 %
Epoch 53 of 100 took 0.823s
  training loss:		-7.892908
  training r:		-0.988828
  validation loss:		0.509303
  validation accuracy:		88.33 %
Epoch 54 of 100 took 0.871s
  training loss:		-7.896554
  training r:		-0.989239
  validation loss:		0.531178
  validation accuracy:		88.33 %
Epoch 55 of 100 took 0.809s
  training loss:		-7.904468
  training r:		-0.989627
  validation loss:		0.503562
  validation accuracy:		87.50 %
Epoch 56 of 100 took 0.872s
  training loss:		-7.907923
  training r:		-0.990001
  validation loss:		0.488410
  validation accuracy:		87.50 %
Epoch 57 of 100 took 0.906s
  training loss:		-7.905569
  training r:		-0.990368
  validation loss:		0.484863
  validation accuracy:		89.17 %
Epoch 58 of 100 took 0.845s
  training loss:		-7.904157
  training r:		-0.990729
  validation loss:		0.535685
  validation accuracy:		85.83 %
Epoch 59 of 100 took 0.844s
  training loss:		-7.923340
  training r:		-0.991076
  validation loss:		0.538463
  validation accuracy:		87.50 %
Epoch 60 of 100 took 0.878s
  training loss:		-7.920550
  training r:		-0.991400
  validation loss:		0.518591
  validation accuracy:		85.83 %
Epoch 61 of 100 took 0.889s
  training loss:		-7.921494
  training r:		-0.991697
  validation loss:		0.535752
  validation accuracy:		85.83 %
Epoch 62 of 100 took 0.834s
  training loss:		-7.908226
  training r:		-0.991864
  validation loss:		0.578647
  validation accuracy:		85.83 %
Epoch 63 of 100 took 0.841s
  training loss:		-7.928048
  training r:		-0.991892
  validation loss:		0.586277
  validation accuracy:		85.83 %
Epoch 64 of 100 took 0.904s
  training loss:		-7.917187
  training r:		-0.991920
  validation loss:		0.587151
  validation accuracy:		86.67 %
Epoch 65 of 100 took 0.837s
  training loss:		-7.907629
  training r:		-0.991947
  validation loss:		0.607170
  validation accuracy:		86.67 %
Epoch 66 of 100 took 0.867s
  training loss:		-7.924016
  training r:		-0.991974
  validation loss:		0.609866
  validation accuracy:		87.50 %
Epoch 67 of 100 took 0.816s
  training loss:		-7.929831
  training r:		-0.992003
  validation loss:		0.586289
  validation accuracy:		86.67 %
Epoch 68 of 100 took 0.841s
  training loss:		-7.911479
  training r:		-0.992033
  validation loss:		0.577447
  validation accuracy:		86.67 %
Epoch 69 of 100 took 0.857s
  training loss:		-7.927588
  training r:		-0.992061
  validation loss:		0.574816
  validation accuracy:		85.83 %
Epoch 70 of 100 took 0.822s
  training loss:		-7.927003
  training r:		-0.992091
  validation loss:		0.588033
  validation accuracy:		85.83 %
Epoch 71 of 100 took 0.938s
  training loss:		-7.924026
  training r:		-0.992120
  validation loss:		0.581589
  validation accuracy:		85.83 %
Epoch 72 of 100 took 0.893s
  training loss:		-7.912748
  training r:		-0.992149
  validation loss:		0.581599
  validation accuracy:		86.67 %
Epoch 73 of 100 took 0.870s
  training loss:		-7.930128
  training r:		-0.992177
  validation loss:		0.574786
  validation accuracy:		86.67 %
Epoch 74 of 100 took 0.901s
  training loss:		-7.928704
  training r:		-0.992206
  validation loss:		0.595297
  validation accuracy:		86.67 %
Epoch 75 of 100 took 0.855s
  training loss:		-7.915407
  training r:		-0.992234
  validation loss:		0.608332
  validation accuracy:		86.67 %
Epoch 76 of 100 took 0.859s
  training loss:		-7.926188
  training r:		-0.992261
  validation loss:		0.591171
  validation accuracy:		85.83 %
Epoch 77 of 100 took 0.824s
  training loss:		-7.919154
  training r:		-0.992289
  validation loss:		0.573272
  validation accuracy:		86.67 %
Epoch 78 of 100 took 0.932s
  training loss:		-7.929198
  training r:		-0.992318
  validation loss:		0.565950
  validation accuracy:		86.67 %
Epoch 79 of 100 took 0.869s
  training loss:		-7.927381
  training r:		-0.992347
  validation loss:		0.567237
  validation accuracy:		86.67 %
Epoch 80 of 100 took 0.986s
  training loss:		-7.927731
  training r:		-0.992375
  validation loss:		0.579288
  validation accuracy:		86.67 %
Epoch 81 of 100 took 0.905s
  training loss:		-7.928633
  training r:		-0.992401
  validation loss:		0.572686
  validation accuracy:		85.83 %
Epoch 82 of 100 took 0.918s
  training loss:		-7.932529
  training r:		-0.992429
  validation loss:		0.575303
  validation accuracy:		86.67 %
Epoch 83 of 100 took 0.898s
  training loss:		-7.921921
  training r:		-0.992456
  validation loss:		0.561457
  validation accuracy:		86.67 %
Epoch 84 of 100 took 0.871s
  training loss:		-7.929183
  training r:		-0.992483
  validation loss:		0.573692
  validation accuracy:		86.67 %
Epoch 85 of 100 took 0.856s
  training loss:		-7.928659
  training r:		-0.992511
  validation loss:		0.578580
  validation accuracy:		86.67 %
Epoch 86 of 100 took 0.876s
  training loss:		-7.931449
  training r:		-0.992538
  validation loss:		0.581843
  validation accuracy:		86.67 %
Epoch 87 of 100 took 0.812s
  training loss:		-7.932735
  training r:		-0.992564
  validation loss:		0.568544
  validation accuracy:		86.67 %
Epoch 88 of 100 took 0.828s
  training loss:		-7.930745
  training r:		-0.992592
  validation loss:		0.572714
  validation accuracy:		86.67 %
Epoch 89 of 100 took 0.851s
  training loss:		-7.930640
  training r:		-0.992620
  validation loss:		0.571921
  validation accuracy:		86.67 %
Epoch 90 of 100 took 0.875s
  training loss:		-7.928927
  training r:		-0.992648
  validation loss:		0.590150
  validation accuracy:		86.67 %
Epoch 91 of 100 took 0.887s
  training loss:		-7.925459
  training r:		-0.992676
  validation loss:		0.578974
  validation accuracy:		86.67 %
Epoch 92 of 100 took 0.865s
  training loss:		-7.932103
  training r:		-0.992703
  validation loss:		0.581737
  validation accuracy:		86.67 %
Epoch 93 of 100 took 0.807s
  training loss:		-7.929784
  training r:		-0.992730
  validation loss:		0.567318
  validation accuracy:		86.67 %
Epoch 94 of 100 took 0.790s
  training loss:		-7.935193
  training r:		-0.992756
  validation loss:		0.576275
  validation accuracy:		86.67 %
Epoch 95 of 100 took 0.775s
  training loss:		-7.926660
  training r:		-0.992783
  validation loss:		0.571012
  validation accuracy:		85.83 %
Epoch 96 of 100 took 0.828s
  training loss:		-7.935988
  training r:		-0.992811
  validation loss:		0.569168
  validation accuracy:		86.67 %
Epoch 97 of 100 took 0.794s
  training loss:		-7.933311
  training r:		-0.992838
  validation loss:		0.553523
  validation accuracy:		86.67 %
Epoch 98 of 100 took 0.794s
  training loss:		-7.934494
  training r:		-0.992865
  validation loss:		0.569028
  validation accuracy:		86.67 %
Epoch 99 of 100 took 0.783s
  training loss:		-7.934685
  training r:		-0.992890
  validation loss:		0.588228
  validation accuracy:		86.67 %
Epoch 100 of 100 took 0.864s
  training loss:		-7.932996
  training r:		-0.992916
  validation loss:		0.568500
  validation accuracy:		86.67 %
Final results:
  test loss:			0.568500
  test accuracy:		86.67 %
tensor([ 0,  0,  0,  1,  1,  1,  2, 22, 22,  3, 19,  3,  4,  4, 35,  5,  5,  5,
         6,  6,  6,  7,  7,  7,  8,  8,  8,  9,  9,  7, 10, 10, 10, 11, 11, 11,
        37,  4, 12, 13], device='cuda:0')
[ 0  0  0  1  1  1  2  2  2  3  3  3  4  4  4  5  5  5  6  6  6  7  7  7
  8  8  8  9  9  9 10 10 10 11 11 11 12 12 12 13 13 13 14 14 14 15 15 15
 16 16 16 17 17 17 18 18 18 19 19 19 20 20 20 21 21 21 22 22 22 23 23 23
 24 24 24 25 25 25 26 26 26 27 27 27 28 28 28 29 29 29 30 30 30 31 31 31
 32 32 32 33 33 33 34 34 34 35 35 35 36 36 36 37 37 37 38 38 38 39 39 39]
tensor([ 1, 13, 14, 14, 20, 15, 15, 15, 16, 16, 16, 17,  5,  5, 18, 18, 18, 19,
        19, 19, 28, 20, 20, 21, 21, 21, 22, 11, 11, 23, 23, 23, 24, 24, 24, 25,
        25, 25, 26, 26], device='cuda:0')
[ 0  0  0  1  1  1  2  2  2  3  3  3  4  4  4  5  5  5  6  6  6  7  7  7
  8  8  8  9  9  9 10 10 10 11 11 11 12 12 12 13 13 13 14 14 14 15 15 15
 16 16 16 17 17 17 18 18 18 19 19 19 20 20 20 21 21 21 22 22 22 23 23 23
 24 24 24 25 25 25 26 26 26 27 27 27 28 28 28 29 29 29 30 30 30 31 31 31
 32 32 32 33 33 33 34 34 34 35 35 35 36 36 36 37 37 37 38 38 38 39 39 39]
tensor([26, 27, 27, 27, 28, 38, 28, 29, 29, 29, 30, 30, 30, 31, 31, 31, 32, 32,
        32, 33, 33, 33, 34, 34, 34, 35, 35, 35, 36, 36, 36, 37, 37, 37, 38, 38,
        38, 39, 35, 39], device='cuda:0')
[ 0  0  0  1  1  1  2  2  2  3  3  3  4  4  4  5  5  5  6  6  6  7  7  7
  8  8  8  9  9  9 10 10 10 11 11 11 12 12 12 13 13 13 14 14 14 15 15 15
 16 16 16 17 17 17 18 18 18 19 19 19 20 20 20 21 21 21 22 22 22 23 23 23
 24 24 24 25 25 25 26 26 26 27 27 27 28 28 28 29 29 29 30 30 30 31 31 31
 32 32 32 33 33 33 34 34 34 35 35 35 36 36 36 37 37 37 38 38 38 39 39 39]
0.8666666666666666
