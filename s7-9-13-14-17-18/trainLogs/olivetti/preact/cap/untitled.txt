Loading data...
Number of encoded image: 4
Number of synthesized data: 8192
Number of training data, output: 560, 40...
Building model and compiling functions...
Number of parameters in model: 11186536
Starting training...
train.py:71: DeprecationWarning: This function is deprecated. Please call randint(0, 8 + 1) instead
  crops = np.random.random_integers(0, high=8, size=(batchsize, 2))
Epoch 1 of 100 took 8.768s
  training loss:		2.221010
  malicious loss:		1.516533
  malicious accuracy:		42.06 %
  validation loss:		3.938700
  validation accuracy:		7.50 %
Epoch 2 of 100 took 7.978s
  training loss:		1.828286
  malicious loss:		1.554959
  malicious accuracy:		29.87 %
  validation loss:		3.244228
  validation accuracy:		11.67 %
Epoch 3 of 100 took 7.811s
  training loss:		1.808329
  malicious loss:		1.853367
  malicious accuracy:		29.19 %
  validation loss:		3.197909
  validation accuracy:		9.17 %
Epoch 4 of 100 took 7.804s
  training loss:		1.875943
  malicious loss:		1.517121
  malicious accuracy:		42.06 %
  validation loss:		3.239081
  validation accuracy:		11.67 %
Epoch 5 of 100 took 7.737s
  training loss:		1.804066
  malicious loss:		1.442037
  malicious accuracy:		43.86 %
  validation loss:		3.545465
  validation accuracy:		14.17 %
Epoch 6 of 100 took 7.638s
  training loss:		1.793232
  malicious loss:		1.489155
  malicious accuracy:		42.06 %
  validation loss:		2.887813
  validation accuracy:		20.83 %
Epoch 7 of 100 took 7.662s
  training loss:		1.725634
  malicious loss:		1.379961
  malicious accuracy:		45.76 %
  validation loss:		2.612725
  validation accuracy:		30.00 %
Epoch 8 of 100 took 7.688s
  training loss:		1.718061
  malicious loss:		1.358299
  malicious accuracy:		46.92 %
  validation loss:		2.473473
  validation accuracy:		26.67 %
Epoch 9 of 100 took 7.658s
  training loss:		1.642702
  malicious loss:		1.336482
  malicious accuracy:		47.89 %
  validation loss:		2.590993
  validation accuracy:		20.83 %
Epoch 10 of 100 took 7.653s
  training loss:		1.578339
  malicious loss:		1.123784
  malicious accuracy:		55.83 %
  validation loss:		2.569125
  validation accuracy:		28.33 %
Epoch 11 of 100 took 7.776s
  training loss:		1.485981
  malicious loss:		1.054316
  malicious accuracy:		58.86 %
  validation loss:		2.016372
  validation accuracy:		45.83 %
Epoch 12 of 100 took 7.811s
  training loss:		1.389667
  malicious loss:		1.013927
  malicious accuracy:		58.06 %
  validation loss:		2.046110
  validation accuracy:		48.33 %
Epoch 13 of 100 took 7.782s
  training loss:		1.272670
  malicious loss:		0.944171
  malicious accuracy:		62.87 %
  validation loss:		1.936352
  validation accuracy:		39.17 %
Epoch 14 of 100 took 7.752s
  training loss:		1.214151
  malicious loss:		1.028715
  malicious accuracy:		58.25 %
  validation loss:		1.858977
  validation accuracy:		43.33 %
Epoch 15 of 100 took 7.690s
  training loss:		1.154280
  malicious loss:		0.967811
  malicious accuracy:		62.75 %
  validation loss:		1.927759
  validation accuracy:		44.17 %
Epoch 16 of 100 took 7.637s
  training loss:		1.066393
  malicious loss:		0.805060
  malicious accuracy:		67.18 %
  validation loss:		1.571375
  validation accuracy:		58.33 %
Epoch 17 of 100 took 7.674s
  training loss:		0.971875
  malicious loss:		0.733490
  malicious accuracy:		69.34 %
  validation loss:		1.247207
  validation accuracy:		59.17 %
Epoch 18 of 100 took 7.708s
  training loss:		0.912575
  malicious loss:		0.956082
  malicious accuracy:		63.76 %
  validation loss:		1.564785
  validation accuracy:		59.17 %
Epoch 19 of 100 took 7.702s
  training loss:		0.875719
  malicious loss:		0.633420
  malicious accuracy:		74.18 %
  validation loss:		1.042595
  validation accuracy:		67.50 %
Epoch 20 of 100 took 7.672s
  training loss:		0.817106
  malicious loss:		0.633284
  malicious accuracy:		74.00 %
  validation loss:		0.953768
  validation accuracy:		70.00 %
Epoch 21 of 100 took 7.664s
  training loss:		0.765386
  malicious loss:		0.689981
  malicious accuracy:		72.48 %
  validation loss:		0.916145
  validation accuracy:		74.17 %
Epoch 22 of 100 took 7.706s
  training loss:		0.719752
  malicious loss:		0.583409
  malicious accuracy:		76.08 %
  validation loss:		0.852189
  validation accuracy:		75.00 %
Epoch 23 of 100 took 7.668s
  training loss:		0.694435
  malicious loss:		0.747266
  malicious accuracy:		69.33 %
  validation loss:		0.919851
  validation accuracy:		75.00 %
Epoch 24 of 100 took 7.704s
  training loss:		0.699353
  malicious loss:		0.672328
  malicious accuracy:		71.81 %
  validation loss:		0.873065
  validation accuracy:		79.17 %
Epoch 25 of 100 took 7.690s
  training loss:		0.638641
  malicious loss:		0.554199
  malicious accuracy:		77.48 %
  validation loss:		0.909253
  validation accuracy:		75.00 %
Epoch 26 of 100 took 7.671s
  training loss:		0.626882
  malicious loss:		0.584483
  malicious accuracy:		75.67 %
  validation loss:		0.955280
  validation accuracy:		75.83 %
Epoch 27 of 100 took 7.636s
  training loss:		0.614332
  malicious loss:		0.560895
  malicious accuracy:		77.38 %
  validation loss:		0.637139
  validation accuracy:		85.00 %
Epoch 28 of 100 took 7.652s
  training loss:		0.554684
  malicious loss:		0.484011
  malicious accuracy:		79.36 %
  validation loss:		0.463022
  validation accuracy:		85.83 %
Epoch 29 of 100 took 7.664s
  training loss:		0.554861
  malicious loss:		0.449969
  malicious accuracy:		82.23 %
  validation loss:		0.773832
  validation accuracy:		81.67 %
Epoch 30 of 100 took 7.648s
  training loss:		0.559998
  malicious loss:		0.470203
  malicious accuracy:		81.07 %
  validation loss:		0.684917
  validation accuracy:		82.50 %
Epoch 31 of 100 took 7.664s
  training loss:		0.520032
  malicious loss:		0.406946
  malicious accuracy:		82.83 %
  validation loss:		0.725717
  validation accuracy:		82.50 %
Epoch 32 of 100 took 7.658s
  training loss:		0.514182
  malicious loss:		0.408766
  malicious accuracy:		83.38 %
  validation loss:		0.664282
  validation accuracy:		82.50 %
Epoch 33 of 100 took 7.702s
  training loss:		0.492776
  malicious loss:		0.408521
  malicious accuracy:		83.21 %
  validation loss:		0.629137
  validation accuracy:		85.83 %
Epoch 34 of 100 took 7.681s
  training loss:		0.477740
  malicious loss:		0.452308
  malicious accuracy:		81.48 %
  validation loss:		0.686592
  validation accuracy:		82.50 %
Epoch 35 of 100 took 7.732s
  training loss:		0.465249
  malicious loss:		0.395653
  malicious accuracy:		83.44 %
  validation loss:		0.769786
  validation accuracy:		81.67 %
Epoch 36 of 100 took 7.688s
  training loss:		0.440689
  malicious loss:		0.690875
  malicious accuracy:		75.62 %
  validation loss:		0.889170
  validation accuracy:		84.17 %
Epoch 37 of 100 took 7.696s
  training loss:		0.436953
  malicious loss:		0.396821
  malicious accuracy:		83.76 %
  validation loss:		0.759796
  validation accuracy:		84.17 %
Epoch 38 of 100 took 7.641s
  training loss:		0.434842
  malicious loss:		0.477526
  malicious accuracy:		80.37 %
  validation loss:		1.095730
  validation accuracy:		79.17 %
Epoch 39 of 100 took 7.640s
  training loss:		0.414095
  malicious loss:		0.413007
  malicious accuracy:		83.92 %
  validation loss:		0.635079
  validation accuracy:		84.17 %
Epoch 40 of 100 took 7.648s
  training loss:		0.426496
  malicious loss:		0.405370
  malicious accuracy:		83.90 %
  validation loss:		0.444095
  validation accuracy:		88.33 %
Epoch 41 of 100 took 7.634s
  training loss:		0.424635
  malicious loss:		0.352786
  malicious accuracy:		85.81 %
  validation loss:		0.597227
  validation accuracy:		86.67 %
Epoch 42 of 100 took 7.677s
  training loss:		0.262753
  malicious loss:		0.195505
  malicious accuracy:		93.26 %
  validation loss:		0.413336
  validation accuracy:		91.67 %
Epoch 43 of 100 took 7.648s
  training loss:		0.198729
  malicious loss:		0.167701
  malicious accuracy:		94.53 %
  validation loss:		0.436363
  validation accuracy:		89.17 %
Epoch 44 of 100 took 7.664s
  training loss:		0.174838
  malicious loss:		0.157984
  malicious accuracy:		94.82 %
  validation loss:		0.441961
  validation accuracy:		86.67 %
Epoch 45 of 100 took 7.696s
  training loss:		0.166784
  malicious loss:		0.138987
  malicious accuracy:		95.67 %
  validation loss:		0.436532
  validation accuracy:		90.00 %
Epoch 46 of 100 took 7.666s
  training loss:		0.155780
  malicious loss:		0.130124
  malicious accuracy:		95.94 %
  validation loss:		0.482257
  validation accuracy:		90.00 %
Epoch 47 of 100 took 7.640s
  training loss:		0.143550
  malicious loss:		0.118107
  malicious accuracy:		96.38 %
  validation loss:		0.429968
  validation accuracy:		90.00 %
Epoch 48 of 100 took 7.663s
  training loss:		0.134354
  malicious loss:		0.120805
  malicious accuracy:		96.07 %
  validation loss:		0.448749
  validation accuracy:		88.33 %
Epoch 49 of 100 took 7.641s
  training loss:		0.125856
  malicious loss:		0.098663
  malicious accuracy:		97.25 %
  validation loss:		0.437752
  validation accuracy:		90.83 %
Epoch 50 of 100 took 7.664s
  training loss:		0.120859
  malicious loss:		0.092981
  malicious accuracy:		97.37 %
  validation loss:		0.442312
  validation accuracy:		92.50 %
Epoch 51 of 100 took 7.640s
  training loss:		0.110138
  malicious loss:		0.088188
  malicious accuracy:		97.32 %
  validation loss:		0.442298
  validation accuracy:		90.00 %
Epoch 52 of 100 took 7.664s
  training loss:		0.107087
  malicious loss:		0.074957
  malicious accuracy:		98.21 %
  validation loss:		0.424904
  validation accuracy:		91.67 %
Epoch 53 of 100 took 7.694s
  training loss:		0.096403
  malicious loss:		0.077558
  malicious accuracy:		97.68 %
  validation loss:		0.446269
  validation accuracy:		90.83 %
Epoch 54 of 100 took 7.651s
  training loss:		0.092064
  malicious loss:		0.068281
  malicious accuracy:		98.41 %
  validation loss:		0.492417
  validation accuracy:		87.50 %
Epoch 55 of 100 took 7.683s
  training loss:		0.086270
  malicious loss:		0.058151
  malicious accuracy:		98.58 %
  validation loss:		0.455034
  validation accuracy:		90.00 %
Epoch 56 of 100 took 7.682s
  training loss:		0.085333
  malicious loss:		0.056125
  malicious accuracy:		98.74 %
  validation loss:		0.495188
  validation accuracy:		88.33 %
Epoch 57 of 100 took 7.656s
  training loss:		0.079735
  malicious loss:		0.053535
  malicious accuracy:		98.80 %
  validation loss:		0.421848
  validation accuracy:		89.17 %
Epoch 58 of 100 took 7.656s
  training loss:		0.073368
  malicious loss:		0.048281
  malicious accuracy:		99.04 %
  validation loss:		0.484459
  validation accuracy:		88.33 %
Epoch 59 of 100 took 7.656s
  training loss:		0.067507
  malicious loss:		0.040401
  malicious accuracy:		99.33 %
  validation loss:		0.518211
  validation accuracy:		89.17 %
Epoch 60 of 100 took 7.640s
  training loss:		0.065010
  malicious loss:		0.044020
  malicious accuracy:		99.19 %
  validation loss:		0.417519
  validation accuracy:		91.67 %
Epoch 61 of 100 took 7.659s
  training loss:		0.059036
  malicious loss:		0.037344
  malicious accuracy:		99.38 %
  validation loss:		0.487460
  validation accuracy:		88.33 %
Epoch 62 of 100 took 7.649s
  training loss:		0.048844
  malicious loss:		0.029250
  malicious accuracy:		99.77 %
  validation loss:		0.482388
  validation accuracy:		88.33 %
Epoch 63 of 100 took 7.654s
  training loss:		0.045806
  malicious loss:		0.028889
  malicious accuracy:		99.77 %
  validation loss:		0.476686
  validation accuracy:		88.33 %
Epoch 64 of 100 took 7.632s
  training loss:		0.041344
  malicious loss:		0.027109
  malicious accuracy:		99.82 %
  validation loss:		0.470690
  validation accuracy:		89.17 %
Epoch 65 of 100 took 7.648s
  training loss:		0.041735
  malicious loss:		0.026054
  malicious accuracy:		99.80 %
  validation loss:		0.477235
  validation accuracy:		89.17 %
Epoch 66 of 100 took 7.670s
  training loss:		0.038406
  malicious loss:		0.025601
  malicious accuracy:		99.80 %
  validation loss:		0.492244
  validation accuracy:		89.17 %
Epoch 67 of 100 took 7.672s
  training loss:		0.037573
  malicious loss:		0.024555
  malicious accuracy:		99.85 %
  validation loss:		0.494979
  validation accuracy:		89.17 %
Epoch 68 of 100 took 7.628s
  training loss:		0.037521
  malicious loss:		0.025997
  malicious accuracy:		99.82 %
  validation loss:		0.476182
  validation accuracy:		89.17 %
Epoch 69 of 100 took 7.624s
  training loss:		0.037924
  malicious loss:		0.024027
  malicious accuracy:		99.85 %
  validation loss:		0.496396
  validation accuracy:		88.33 %
Epoch 70 of 100 took 7.624s
  training loss:		0.039118
  malicious loss:		0.022403
  malicious accuracy:		99.87 %
  validation loss:		0.494251
  validation accuracy:		89.17 %
Epoch 71 of 100 took 7.643s
  training loss:		0.034357
  malicious loss:		0.023121
  malicious accuracy:		99.84 %
  validation loss:		0.499307
  validation accuracy:		88.33 %
Epoch 72 of 100 took 7.620s
  training loss:		0.036142
  malicious loss:		0.023100
  malicious accuracy:		99.87 %
  validation loss:		0.496871
  validation accuracy:		89.17 %
Epoch 73 of 100 took 7.633s
  training loss:		0.037393
  malicious loss:		0.024162
  malicious accuracy:		99.87 %
  validation loss:		0.482680
  validation accuracy:		88.33 %
Epoch 74 of 100 took 7.632s
  training loss:		0.037535
  malicious loss:		0.022177
  malicious accuracy:		99.90 %
  validation loss:		0.490766
  validation accuracy:		89.17 %
Epoch 75 of 100 took 7.640s
  training loss:		0.034508
  malicious loss:		0.022246
  malicious accuracy:		99.88 %
  validation loss:		0.507653
  validation accuracy:		88.33 %
Epoch 76 of 100 took 7.660s
  training loss:		0.035184
  malicious loss:		0.021951
  malicious accuracy:		99.88 %
  validation loss:		0.487440
  validation accuracy:		89.17 %
Epoch 77 of 100 took 7.650s
  training loss:		0.035891
  malicious loss:		0.021425
  malicious accuracy:		99.88 %
  validation loss:		0.496883
  validation accuracy:		90.00 %
Epoch 78 of 100 took 7.644s
  training loss:		0.036245
  malicious loss:		0.020524
  malicious accuracy:		99.91 %
  validation loss:		0.502792
  validation accuracy:		88.33 %
Epoch 79 of 100 took 7.624s
  training loss:		0.033219
  malicious loss:		0.019819
  malicious accuracy:		99.93 %
  validation loss:		0.491923
  validation accuracy:		88.33 %
Epoch 80 of 100 took 7.648s
  training loss:		0.032653
  malicious loss:		0.019695
  malicious accuracy:		99.93 %
  validation loss:		0.497374
  validation accuracy:		88.33 %
Epoch 81 of 100 took 7.632s
  training loss:		0.032164
  malicious loss:		0.020256
  malicious accuracy:		99.94 %
  validation loss:		0.485417
  validation accuracy:		87.50 %
Epoch 82 of 100 took 7.640s
  training loss:		0.031248
  malicious loss:		0.019173
  malicious accuracy:		99.93 %
  validation loss:		0.479622
  validation accuracy:		89.17 %
Epoch 83 of 100 took 7.632s
  training loss:		0.033696
  malicious loss:		0.019679
  malicious accuracy:		99.93 %
  validation loss:		0.487058
  validation accuracy:		89.17 %
Epoch 84 of 100 took 7.650s
  training loss:		0.032200
  malicious loss:		0.019539
  malicious accuracy:		99.93 %
  validation loss:		0.477604
  validation accuracy:		90.00 %
Epoch 85 of 100 took 7.640s
  training loss:		0.031650
  malicious loss:		0.020649
  malicious accuracy:		99.90 %
  validation loss:		0.465649
  validation accuracy:		90.00 %
Epoch 86 of 100 took 7.640s
  training loss:		0.031194
  malicious loss:		0.018936
  malicious accuracy:		99.94 %
  validation loss:		0.468831
  validation accuracy:		90.00 %
Epoch 87 of 100 took 7.662s
  training loss:		0.029557
  malicious loss:		0.017679
  malicious accuracy:		99.94 %
  validation loss:		0.512535
  validation accuracy:		89.17 %
Epoch 88 of 100 took 7.624s
  training loss:		0.029712
  malicious loss:		0.018197
  malicious accuracy:		99.94 %
  validation loss:		0.475103
  validation accuracy:		89.17 %
Epoch 89 of 100 took 7.643s
  training loss:		0.033032
  malicious loss:		0.017860
  malicious accuracy:		99.95 %
  validation loss:		0.469342
  validation accuracy:		90.83 %
Epoch 90 of 100 took 7.625s
  training loss:		0.030361
  malicious loss:		0.018047
  malicious accuracy:		99.93 %
  validation loss:		0.466433
  validation accuracy:		90.83 %
Epoch 91 of 100 took 7.636s
  training loss:		0.031297
  malicious loss:		0.017358
  malicious accuracy:		99.95 %
  validation loss:		0.490459
  validation accuracy:		89.17 %
Epoch 92 of 100 took 7.628s
  training loss:		0.033802
  malicious loss:		0.018565
  malicious accuracy:		99.93 %
  validation loss:		0.460584
  validation accuracy:		90.83 %
Epoch 93 of 100 took 7.632s
  training loss:		0.030672
  malicious loss:		0.018068
  malicious accuracy:		99.89 %
  validation loss:		0.470917
  validation accuracy:		90.00 %
Epoch 94 of 100 took 7.649s
  training loss:		0.030789
  malicious loss:		0.016171
  malicious accuracy:		99.95 %
  validation loss:		0.478600
  validation accuracy:		87.50 %
Epoch 95 of 100 took 7.621s
  training loss:		0.028999
  malicious loss:		0.016743
  malicious accuracy:		99.95 %
  validation loss:		0.485938
  validation accuracy:		89.17 %
Epoch 96 of 100 took 7.648s
  training loss:		0.030244
  malicious loss:		0.016209
  malicious accuracy:		99.95 %
  validation loss:		0.504013
  validation accuracy:		89.17 %
Epoch 97 of 100 took 7.670s
  training loss:		0.028425
  malicious loss:		0.016112
  malicious accuracy:		99.96 %
  validation loss:		0.488096
  validation accuracy:		90.00 %
Epoch 98 of 100 took 7.627s
  training loss:		0.027718
  malicious loss:		0.015748
  malicious accuracy:		99.95 %
  validation loss:		0.487747
  validation accuracy:		90.00 %
Epoch 99 of 100 took 7.628s
  training loss:		0.028697
  malicious loss:		0.016885
  malicious accuracy:		99.93 %
  validation loss:		0.477690
  validation accuracy:		90.00 %
Epoch 100 of 100 took 7.640s
  training loss:		0.028575
  malicious loss:		0.015242
  malicious accuracy:		99.96 %
  validation loss:		0.504877
  validation accuracy:		89.17 %
Final results:
  test loss:			0.504877
  test accuracy:		89.17 %
0.8916666666666666
