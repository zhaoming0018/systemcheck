Loading data...
Number of encoded image: 1
Number of synthesized data: 2048
Number of training data, output: 560, 40...
Building model and compiling functions...
Number of parameters in model: 11186536
Starting training...
train.py:71: DeprecationWarning: This function is deprecated. Please call randint(0, 8 + 1) instead
  crops = np.random.random_integers(0, high=8, size=(batchsize, 2))
Epoch 1 of 100 took 3.103s
  training loss:		2.734557
  malicious loss:		1.758312
  malicious accuracy:		36.42 %
  validation loss:		4.518679
  validation accuracy:		8.33 %
Epoch 2 of 100 took 2.611s
  training loss:		2.441932
  malicious loss:		1.410588
  malicious accuracy:		47.70 %
  validation loss:		3.605964
  validation accuracy:		7.50 %
Epoch 3 of 100 took 2.556s
  training loss:		2.268728
  malicious loss:		1.424465
  malicious accuracy:		47.70 %
  validation loss:		3.028825
  validation accuracy:		12.50 %
Epoch 4 of 100 took 2.548s
  training loss:		2.189021
  malicious loss:		1.365720
  malicious accuracy:		47.70 %
  validation loss:		2.715257
  validation accuracy:		26.67 %
Epoch 5 of 100 took 2.570s
  training loss:		1.991583
  malicious loss:		1.379578
  malicious accuracy:		47.70 %
  validation loss:		2.448121
  validation accuracy:		33.33 %
Epoch 6 of 100 took 2.527s
  training loss:		1.885519
  malicious loss:		1.406216
  malicious accuracy:		47.70 %
  validation loss:		2.092537
  validation accuracy:		36.67 %
Epoch 7 of 100 took 2.575s
  training loss:		1.815810
  malicious loss:		1.374141
  malicious accuracy:		47.70 %
  validation loss:		2.078918
  validation accuracy:		40.83 %
Epoch 8 of 100 took 2.571s
  training loss:		1.642094
  malicious loss:		1.592156
  malicious accuracy:		47.70 %
  validation loss:		2.079696
  validation accuracy:		35.83 %
Epoch 9 of 100 took 2.527s
  training loss:		1.544290
  malicious loss:		1.715332
  malicious accuracy:		27.11 %
  validation loss:		1.391817
  validation accuracy:		56.67 %
Epoch 10 of 100 took 2.516s
  training loss:		1.455472
  malicious loss:		1.377260
  malicious accuracy:		47.70 %
  validation loss:		1.495962
  validation accuracy:		55.00 %
Epoch 11 of 100 took 2.580s
  training loss:		1.436430
  malicious loss:		3.118697
  malicious accuracy:		0.15 %
  validation loss:		1.797993
  validation accuracy:		49.17 %
Epoch 12 of 100 took 2.561s
  training loss:		1.383458
  malicious loss:		1.937019
  malicious accuracy:		47.70 %
  validation loss:		2.401368
  validation accuracy:		44.17 %
Epoch 13 of 100 took 2.589s
  training loss:		1.361313
  malicious loss:		2.047354
  malicious accuracy:		47.70 %
  validation loss:		1.536751
  validation accuracy:		54.17 %
Epoch 14 of 100 took 2.526s
  training loss:		1.254430
  malicious loss:		2.354930
  malicious accuracy:		47.70 %
  validation loss:		1.352231
  validation accuracy:		67.50 %
Epoch 15 of 100 took 2.527s
  training loss:		1.231813
  malicious loss:		1.102257
  malicious accuracy:		55.05 %
  validation loss:		1.073412
  validation accuracy:		69.17 %
Epoch 16 of 100 took 2.545s
  training loss:		1.175788
  malicious loss:		0.987390
  malicious accuracy:		60.25 %
  validation loss:		1.057100
  validation accuracy:		72.50 %
Epoch 17 of 100 took 2.533s
  training loss:		1.044597
  malicious loss:		1.995184
  malicious accuracy:		56.32 %
  validation loss:		1.168640
  validation accuracy:		66.67 %
Epoch 18 of 100 took 2.516s
  training loss:		0.959758
  malicious loss:		1.184390
  malicious accuracy:		54.71 %
  validation loss:		0.864565
  validation accuracy:		70.83 %
Epoch 19 of 100 took 2.582s
  training loss:		0.923789
  malicious loss:		0.781284
  malicious accuracy:		70.78 %
  validation loss:		0.947596
  validation accuracy:		73.33 %
Epoch 20 of 100 took 2.510s
  training loss:		0.807554
  malicious loss:		0.944903
  malicious accuracy:		63.48 %
  validation loss:		0.905383
  validation accuracy:		77.50 %
Epoch 21 of 100 took 2.528s
  training loss:		0.761448
  malicious loss:		0.676404
  malicious accuracy:		72.11 %
  validation loss:		0.922305
  validation accuracy:		83.33 %
Epoch 22 of 100 took 2.532s
  training loss:		0.700632
  malicious loss:		0.754327
  malicious accuracy:		67.94 %
  validation loss:		0.885224
  validation accuracy:		82.50 %
Epoch 23 of 100 took 2.548s
  training loss:		0.658863
  malicious loss:		0.660732
  malicious accuracy:		71.62 %
  validation loss:		0.807185
  validation accuracy:		85.00 %
Epoch 24 of 100 took 2.554s
  training loss:		0.621521
  malicious loss:		1.222469
  malicious accuracy:		58.24 %
  validation loss:		1.140344
  validation accuracy:		75.00 %
Epoch 25 of 100 took 2.544s
  training loss:		0.563884
  malicious loss:		0.577714
  malicious accuracy:		75.59 %
  validation loss:		0.873956
  validation accuracy:		80.00 %
Epoch 26 of 100 took 2.512s
  training loss:		0.557869
  malicious loss:		0.639603
  malicious accuracy:		72.84 %
  validation loss:		0.996989
  validation accuracy:		79.17 %
Epoch 27 of 100 took 2.528s
  training loss:		0.558864
  malicious loss:		0.516124
  malicious accuracy:		77.40 %
  validation loss:		0.945950
  validation accuracy:		80.83 %
Epoch 28 of 100 took 2.512s
  training loss:		0.510209
  malicious loss:		0.422077
  malicious accuracy:		82.79 %
  validation loss:		1.107124
  validation accuracy:		72.50 %
Epoch 29 of 100 took 2.528s
  training loss:		0.453280
  malicious loss:		0.419859
  malicious accuracy:		82.45 %
  validation loss:		0.649312
  validation accuracy:		85.00 %
Epoch 30 of 100 took 2.556s
  training loss:		0.448233
  malicious loss:		0.480087
  malicious accuracy:		80.83 %
  validation loss:		0.703256
  validation accuracy:		85.83 %
Epoch 31 of 100 took 2.542s
  training loss:		0.422845
  malicious loss:		0.414271
  malicious accuracy:		82.70 %
  validation loss:		0.989148
  validation accuracy:		84.17 %
Epoch 32 of 100 took 2.539s
  training loss:		0.410646
  malicious loss:		0.514557
  malicious accuracy:		77.40 %
  validation loss:		0.620792
  validation accuracy:		85.83 %
Epoch 33 of 100 took 2.512s
  training loss:		0.394691
  malicious loss:		0.447186
  malicious accuracy:		81.81 %
  validation loss:		0.919335
  validation accuracy:		82.50 %
Epoch 34 of 100 took 2.536s
  training loss:		0.379900
  malicious loss:		0.469887
  malicious accuracy:		79.71 %
  validation loss:		0.716465
  validation accuracy:		86.67 %
Epoch 35 of 100 took 2.535s
  training loss:		0.392923
  malicious loss:		0.640293
  malicious accuracy:		74.12 %
  validation loss:		0.473878
  validation accuracy:		85.83 %
Epoch 36 of 100 took 2.509s
  training loss:		0.401374
  malicious loss:		0.640943
  malicious accuracy:		76.47 %
  validation loss:		1.149143
  validation accuracy:		81.67 %
Epoch 37 of 100 took 2.512s
  training loss:		0.354627
  malicious loss:		0.335402
  malicious accuracy:		86.32 %
  validation loss:		0.472129
  validation accuracy:		87.50 %
Epoch 38 of 100 took 2.531s
  training loss:		0.309451
  malicious loss:		0.312944
  malicious accuracy:		87.16 %
  validation loss:		0.642086
  validation accuracy:		85.83 %
Epoch 39 of 100 took 2.538s
  training loss:		0.336064
  malicious loss:		0.342799
  malicious accuracy:		86.47 %
  validation loss:		0.682587
  validation accuracy:		87.50 %
Epoch 40 of 100 took 2.525s
  training loss:		0.313654
  malicious loss:		0.469397
  malicious accuracy:		79.80 %
  validation loss:		0.697515
  validation accuracy:		85.83 %
Epoch 41 of 100 took 2.513s
  training loss:		0.283633
  malicious loss:		0.415859
  malicious accuracy:		82.50 %
  validation loss:		0.878287
  validation accuracy:		85.00 %
Epoch 42 of 100 took 2.516s
  training loss:		0.221454
  malicious loss:		0.211975
  malicious accuracy:		92.55 %
  validation loss:		0.594689
  validation accuracy:		90.83 %
Epoch 43 of 100 took 2.519s
  training loss:		0.152148
  malicious loss:		0.179893
  malicious accuracy:		93.77 %
  validation loss:		0.606065
  validation accuracy:		92.50 %
Epoch 44 of 100 took 2.536s
  training loss:		0.135653
  malicious loss:		0.166765
  malicious accuracy:		94.61 %
  validation loss:		0.582660
  validation accuracy:		92.50 %
Epoch 45 of 100 took 2.512s
  training loss:		0.137889
  malicious loss:		0.160954
  malicious accuracy:		94.26 %
  validation loss:		0.571489
  validation accuracy:		91.67 %
Epoch 46 of 100 took 2.513s
  training loss:		0.131970
  malicious loss:		0.148895
  malicious accuracy:		95.25 %
  validation loss:		0.597176
  validation accuracy:		91.67 %
Epoch 47 of 100 took 2.527s
  training loss:		0.126053
  malicious loss:		0.137443
  malicious accuracy:		95.93 %
  validation loss:		0.580736
  validation accuracy:		92.50 %
Epoch 48 of 100 took 2.510s
  training loss:		0.111873
  malicious loss:		0.134077
  malicious accuracy:		95.83 %
  validation loss:		0.580038
  validation accuracy:		91.67 %
Epoch 49 of 100 took 2.544s
  training loss:		0.117929
  malicious loss:		0.125285
  malicious accuracy:		96.57 %
  validation loss:		0.559913
  validation accuracy:		91.67 %
Epoch 50 of 100 took 2.540s
  training loss:		0.113093
  malicious loss:		0.130115
  malicious accuracy:		96.08 %
  validation loss:		0.515879
  validation accuracy:		91.67 %
Epoch 51 of 100 took 2.512s
  training loss:		0.099216
  malicious loss:		0.120406
  malicious accuracy:		96.42 %
  validation loss:		0.477584
  validation accuracy:		92.50 %
Epoch 52 of 100 took 2.528s
  training loss:		0.100037
  malicious loss:		0.115838
  malicious accuracy:		96.76 %
  validation loss:		0.483576
  validation accuracy:		92.50 %
Epoch 53 of 100 took 2.568s
  training loss:		0.102481
  malicious loss:		0.107619
  malicious accuracy:		97.30 %
  validation loss:		0.519988
  validation accuracy:		91.67 %
Epoch 54 of 100 took 2.531s
  training loss:		0.095616
  malicious loss:		0.102820
  malicious accuracy:		97.65 %
  validation loss:		0.523416
  validation accuracy:		93.33 %
Epoch 55 of 100 took 2.508s
  training loss:		0.097737
  malicious loss:		0.099910
  malicious accuracy:		97.40 %
  validation loss:		0.517838
  validation accuracy:		92.50 %
Epoch 56 of 100 took 2.524s
  training loss:		0.085897
  malicious loss:		0.089788
  malicious accuracy:		97.70 %
  validation loss:		0.490993
  validation accuracy:		91.67 %
Epoch 57 of 100 took 2.508s
  training loss:		0.086875
  malicious loss:		0.088153
  malicious accuracy:		98.09 %
  validation loss:		0.464977
  validation accuracy:		93.33 %
Epoch 58 of 100 took 2.532s
  training loss:		0.079228
  malicious loss:		0.085859
  malicious accuracy:		97.89 %
  validation loss:		0.485108
  validation accuracy:		92.50 %
Epoch 59 of 100 took 2.512s
  training loss:		0.076780
  malicious loss:		0.083913
  malicious accuracy:		97.94 %
  validation loss:		0.456096
  validation accuracy:		93.33 %
Epoch 60 of 100 took 2.509s
  training loss:		0.073235
  malicious loss:		0.077535
  malicious accuracy:		98.48 %
  validation loss:		0.438344
  validation accuracy:		92.50 %
Epoch 61 of 100 took 2.528s
  training loss:		0.072026
  malicious loss:		0.077090
  malicious accuracy:		98.43 %
  validation loss:		0.444742
  validation accuracy:		91.67 %
Epoch 62 of 100 took 2.524s
  training loss:		0.062406
  malicious loss:		0.071659
  malicious accuracy:		98.68 %
  validation loss:		0.477093
  validation accuracy:		92.50 %
Epoch 63 of 100 took 2.525s
  training loss:		0.062802
  malicious loss:		0.066408
  malicious accuracy:		99.02 %
  validation loss:		0.446435
  validation accuracy:		91.67 %
Epoch 64 of 100 took 2.529s
  training loss:		0.063153
  malicious loss:		0.067481
  malicious accuracy:		98.82 %
  validation loss:		0.454685
  validation accuracy:		92.50 %
Epoch 65 of 100 took 2.528s
  training loss:		0.061360
  malicious loss:		0.064084
  malicious accuracy:		99.02 %
  validation loss:		0.447586
  validation accuracy:		91.67 %
Epoch 66 of 100 took 2.512s
  training loss:		0.060026
  malicious loss:		0.063767
  malicious accuracy:		99.02 %
  validation loss:		0.453028
  validation accuracy:		91.67 %
Epoch 67 of 100 took 2.520s
  training loss:		0.061427
  malicious loss:		0.067136
  malicious accuracy:		98.87 %
  validation loss:		0.444328
  validation accuracy:		92.50 %
Epoch 68 of 100 took 2.527s
  training loss:		0.065078
  malicious loss:		0.068905
  malicious accuracy:		98.97 %
  validation loss:		0.453904
  validation accuracy:		92.50 %
Epoch 69 of 100 took 2.527s
  training loss:		0.061477
  malicious loss:		0.063764
  malicious accuracy:		99.12 %
  validation loss:		0.450853
  validation accuracy:		92.50 %
Epoch 70 of 100 took 2.512s
  training loss:		0.057220
  malicious loss:		0.062639
  malicious accuracy:		99.07 %
  validation loss:		0.461263
  validation accuracy:		92.50 %
Epoch 71 of 100 took 2.535s
  training loss:		0.062848
  malicious loss:		0.066170
  malicious accuracy:		98.87 %
  validation loss:		0.444838
  validation accuracy:		92.50 %
Epoch 72 of 100 took 2.537s
  training loss:		0.059901
  malicious loss:		0.061923
  malicious accuracy:		99.17 %
  validation loss:		0.460921
  validation accuracy:		91.67 %
Epoch 73 of 100 took 2.504s
  training loss:		0.058071
  malicious loss:		0.068609
  malicious accuracy:		98.82 %
  validation loss:		0.467215
  validation accuracy:		91.67 %
Epoch 74 of 100 took 2.508s
  training loss:		0.061136
  malicious loss:		0.060275
  malicious accuracy:		99.12 %
  validation loss:		0.438551
  validation accuracy:		93.33 %
Epoch 75 of 100 took 2.528s
  training loss:		0.055414
  malicious loss:		0.063319
  malicious accuracy:		98.97 %
  validation loss:		0.430160
  validation accuracy:		91.67 %
Epoch 76 of 100 took 2.508s
  training loss:		0.054534
  malicious loss:		0.059558
  malicious accuracy:		99.12 %
  validation loss:		0.448696
  validation accuracy:		91.67 %
Epoch 77 of 100 took 2.548s
  training loss:		0.065220
  malicious loss:		0.061837
  malicious accuracy:		99.02 %
  validation loss:		0.463276
  validation accuracy:		92.50 %
Epoch 78 of 100 took 2.506s
  training loss:		0.060469
  malicious loss:		0.061101
  malicious accuracy:		99.12 %
  validation loss:		0.462730
  validation accuracy:		92.50 %
Epoch 79 of 100 took 2.512s
  training loss:		0.057480
  malicious loss:		0.060325
  malicious accuracy:		99.22 %
  validation loss:		0.467970
  validation accuracy:		92.50 %
Epoch 80 of 100 took 2.505s
  training loss:		0.058361
  malicious loss:		0.059396
  malicious accuracy:		99.31 %
  validation loss:		0.462126
  validation accuracy:		91.67 %
Epoch 81 of 100 took 2.508s
  training loss:		0.055482
  malicious loss:		0.061659
  malicious accuracy:		98.97 %
  validation loss:		0.467106
  validation accuracy:		92.50 %
Epoch 82 of 100 took 2.508s
  training loss:		0.055215
  malicious loss:		0.058896
  malicious accuracy:		99.22 %
  validation loss:		0.463139
  validation accuracy:		92.50 %
Epoch 83 of 100 took 2.508s
  training loss:		0.053243
  malicious loss:		0.065231
  malicious accuracy:		98.87 %
  validation loss:		0.455940
  validation accuracy:		92.50 %
Epoch 84 of 100 took 2.551s
  training loss:		0.055320
  malicious loss:		0.056700
  malicious accuracy:		99.17 %
  validation loss:		0.483726
  validation accuracy:		92.50 %
Epoch 85 of 100 took 2.512s
  training loss:		0.050186
  malicious loss:		0.064398
  malicious accuracy:		98.92 %
  validation loss:		0.466019
  validation accuracy:		92.50 %
Epoch 86 of 100 took 2.511s
  training loss:		0.055190
  malicious loss:		0.059517
  malicious accuracy:		99.12 %
  validation loss:		0.475403
  validation accuracy:		91.67 %
Epoch 87 of 100 took 2.508s
  training loss:		0.054171
  malicious loss:		0.056647
  malicious accuracy:		99.22 %
  validation loss:		0.469784
  validation accuracy:		92.50 %
Epoch 88 of 100 took 2.508s
  training loss:		0.054742
  malicious loss:		0.056442
  malicious accuracy:		99.22 %
  validation loss:		0.474216
  validation accuracy:		92.50 %
Epoch 89 of 100 took 2.508s
  training loss:		0.052659
  malicious loss:		0.056529
  malicious accuracy:		99.22 %
  validation loss:		0.450960
  validation accuracy:		92.50 %
Epoch 90 of 100 took 2.512s
  training loss:		0.052876
  malicious loss:		0.053057
  malicious accuracy:		99.31 %
  validation loss:		0.454572
  validation accuracy:		92.50 %
Epoch 91 of 100 took 2.512s
  training loss:		0.049580
  malicious loss:		0.055477
  malicious accuracy:		99.17 %
  validation loss:		0.463399
  validation accuracy:		92.50 %
Epoch 92 of 100 took 2.505s
  training loss:		0.051614
  malicious loss:		0.054352
  malicious accuracy:		99.26 %
  validation loss:		0.467465
  validation accuracy:		92.50 %
Epoch 93 of 100 took 2.519s
  training loss:		0.058103
  malicious loss:		0.055777
  malicious accuracy:		99.22 %
  validation loss:		0.467441
  validation accuracy:		91.67 %
Epoch 94 of 100 took 2.508s
  training loss:		0.049944
  malicious loss:		0.056947
  malicious accuracy:		99.17 %
  validation loss:		0.453911
  validation accuracy:		91.67 %
Epoch 95 of 100 took 2.508s
  training loss:		0.052201
  malicious loss:		0.052715
  malicious accuracy:		99.26 %
  validation loss:		0.480756
  validation accuracy:		92.50 %
Epoch 96 of 100 took 2.511s
  training loss:		0.052371
  malicious loss:		0.051315
  malicious accuracy:		99.26 %
  validation loss:		0.457617
  validation accuracy:		92.50 %
Epoch 97 of 100 took 2.509s
  training loss:		0.049378
  malicious loss:		0.059860
  malicious accuracy:		98.82 %
  validation loss:		0.466099
  validation accuracy:		92.50 %
Epoch 98 of 100 took 2.512s
  training loss:		0.050502
  malicious loss:		0.051023
  malicious accuracy:		99.26 %
  validation loss:		0.462606
  validation accuracy:		91.67 %
Epoch 99 of 100 took 2.544s
  training loss:		0.056287
  malicious loss:		0.055296
  malicious accuracy:		99.12 %
  validation loss:		0.436680
  validation accuracy:		92.50 %
Epoch 100 of 100 took 2.518s
  training loss:		0.053834
  malicious loss:		0.059774
  malicious accuracy:		99.02 %
  validation loss:		0.454769
  validation accuracy:		92.50 %
Final results:
  test loss:			0.454769
  test accuracy:		92.50 %
1
tensor([ 0,  0, 11,  1,  1,  1,  2,  2,  2,  3,  3,  3,  4,  4, 39,  5,  5,  5,
         6,  6,  6,  7,  7,  7,  8,  8,  8,  9,  9, 10, 10, 10, 10, 11, 11, 11,
        12,  5, 12, 13], device='cuda:0')
[ 0  0  0  1  1  1  2  2  2  3  3  3  4  4  4  5  5  5  6  6  6  7  7  7
  8  8  8  9  9  9 10 10 10 11 11 11 12 12 12 13 13 13 14 14 14 15 15 15
 16 16 16 17 17 17 18 18 18 19 19 19 20 20 20 21 21 21 22 22 22 23 23 23
 24 24 24 25 25 25 26 26 26 27 27 27 28 28 28 29 29 29 30 30 30 31 31 31
 32 32 32 33 33 33 34 34 34 35 35 35 36 36 36 37 37 37 38 38 38 39 39 39]
tensor([13, 13, 14, 14, 14, 15, 15, 15, 16, 16, 16, 17, 17, 17, 18, 18, 18, 19,
        19, 19, 28, 28, 20, 21, 21, 21, 22, 22,  3, 23, 23, 23, 24, 24, 24, 25,
        25, 25, 26, 26], device='cuda:0')
[ 0  0  0  1  1  1  2  2  2  3  3  3  4  4  4  5  5  5  6  6  6  7  7  7
  8  8  8  9  9  9 10 10 10 11 11 11 12 12 12 13 13 13 14 14 14 15 15 15
 16 16 16 17 17 17 18 18 18 19 19 19 20 20 20 21 21 21 22 22 22 23 23 23
 24 24 24 25 25 25 26 26 26 27 27 27 28 28 28 29 29 29 30 30 30 31 31 31
 32 32 32 33 33 33 34 34 34 35 35 35 36 36 36 37 37 37 38 38 38 39 39 39]
tensor([26, 27, 27, 27, 28, 28, 28, 29, 29, 29, 30, 30, 30, 26, 26, 31, 32, 32,
        32, 33, 33, 33, 34, 34, 34, 35, 35, 35, 36, 36, 36, 37, 37, 37, 38, 38,
        38, 39, 39, 39], device='cuda:0')
[ 0  0  0  1  1  1  2  2  2  3  3  3  4  4  4  5  5  5  6  6  6  7  7  7
  8  8  8  9  9  9 10 10 10 11 11 11 12 12 12 13 13 13 14 14 14 15 15 15
 16 16 16 17 17 17 18 18 18 19 19 19 20 20 20 21 21 21 22 22 22 23 23 23
 24 24 24 25 25 25 26 26 26 27 27 27 28 28 28 29 29 29 30 30 30 31 31 31
 32 32 32 33 33 33 34 34 34 35 35 35 36 36 36 37 37 37 38 38 38 39 39 39]
0.925
